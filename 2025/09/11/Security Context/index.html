<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Security Context | Hui's Blog</title><meta name="author" content="å…­ä¸€"><meta name="copyright" content="å…­ä¸€"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Security Context æˆ‘ä»¬æœ‰æ—¶å€™åœ¨è¿è¡Œä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ sysctl å‘½ä»¤æ¥ä¿®æ”¹å†…æ ¸å‚æ•°ï¼Œæ¯”å¦‚ netã€vmã€kernel ç­‰å‚æ•°ï¼Œä½†æ˜¯ systcl éœ€è¦å®¹å™¨æ‹¥æœ‰è¶…çº§æƒé™ï¼Œæ‰å¯ä»¥ä½¿ç”¨ï¼Œåœ¨ Docker å®¹å™¨å¯åŠ¨çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥åŠ ä¸Š --privileged å‚æ•°æ¥ä½¿ç”¨ç‰¹æƒæ¨¡å¼ã€‚é‚£ä¹ˆåœ¨ Kubernetes ä¸­åº”è¯¥å¦‚ä½•æ¥ä½¿ç”¨å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ° Kubernetes">
<meta property="og:type" content="article">
<meta property="og:title" content="Security Context">
<meta property="og:url" content="http://example.com/2025/09/11/Security%20Context/index.html">
<meta property="og:site_name" content="Hui&#39;s Blog">
<meta property="og:description" content="Security Context æˆ‘ä»¬æœ‰æ—¶å€™åœ¨è¿è¡Œä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ sysctl å‘½ä»¤æ¥ä¿®æ”¹å†…æ ¸å‚æ•°ï¼Œæ¯”å¦‚ netã€vmã€kernel ç­‰å‚æ•°ï¼Œä½†æ˜¯ systcl éœ€è¦å®¹å™¨æ‹¥æœ‰è¶…çº§æƒé™ï¼Œæ‰å¯ä»¥ä½¿ç”¨ï¼Œåœ¨ Docker å®¹å™¨å¯åŠ¨çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥åŠ ä¸Š --privileged å‚æ•°æ¥ä½¿ç”¨ç‰¹æƒæ¨¡å¼ã€‚é‚£ä¹ˆåœ¨ Kubernetes ä¸­åº”è¯¥å¦‚ä½•æ¥ä½¿ç”¨å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ° Kubernetes">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-09-11T12:32:34.000Z">
<meta property="article:modified_time" content="2025-09-11T13:54:59.336Z">
<meta property="article:author" content="å…­ä¸€">
<meta property="article:tag" content="è¿ç»´">
<meta property="article:tag" content="k8s">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Security Context",
  "url": "http://example.com/2025/09/11/Security%20Context/",
  "image": "http://example.com/img/butterfly-icon.png",
  "datePublished": "2025-09-11T12:32:34.000Z",
  "dateModified": "2025-09-11T13:54:59.336Z",
  "author": [
    {
      "@type": "Person",
      "name": "å…­ä¸€",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/09/11/Security%20Context/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Security Context',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">274</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">45</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hui's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Security Context</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Security Context</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-09-11T12:32:34.000Z" title="å‘è¡¨äº 2025-09-11 20:32:34">2025-09-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-09-11T13:54:59.336Z" title="æ›´æ–°äº 2025-09-11 21:54:59">2025-09-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/k8s/">k8s</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/k8s/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/">é…ç½®ç®¡ç†</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Security-Context"><a href="#Security-Context" class="headerlink" title="Security Context"></a>Security Context</h1><p><img src="https://mudutestmenu.mudu.tv/upload/yg32hq.jpg" alt="Security Context"></p>
<p>æˆ‘ä»¬æœ‰æ—¶å€™åœ¨è¿è¡Œä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ <code>sysctl</code> å‘½ä»¤æ¥ä¿®æ”¹å†…æ ¸å‚æ•°ï¼Œæ¯”å¦‚ <code>net</code>ã€<code>vm</code>ã€<code>kernel</code> ç­‰å‚æ•°ï¼Œä½†æ˜¯ <code>systcl</code> éœ€è¦å®¹å™¨æ‹¥æœ‰è¶…çº§æƒé™ï¼Œæ‰å¯ä»¥ä½¿ç”¨ï¼Œåœ¨ Docker å®¹å™¨å¯åŠ¨çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥åŠ ä¸Š <code>--privileged</code> å‚æ•°æ¥ä½¿ç”¨ç‰¹æƒæ¨¡å¼ã€‚é‚£ä¹ˆåœ¨ Kubernetes ä¸­åº”è¯¥å¦‚ä½•æ¥ä½¿ç”¨å‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ° Kubernetes ä¸­çš„ <code>Security Context</code>ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„å®‰å…¨ä¸Šä¸‹æ–‡ï¼Œä¸»è¦æ˜¯æ¥é™åˆ¶å®¹å™¨éæ³•æ“ä½œå®¿ä¸»èŠ‚ç‚¹çš„ç³»ç»Ÿçº§åˆ«çš„å†…å®¹ï¼Œä½¿å¾—èŠ‚ç‚¹çš„ç³»ç»Ÿæˆ–è€…èŠ‚ç‚¹ä¸Šå…¶ä»–å®¹å™¨ç»„å—åˆ°å½±å“ã€‚Kubernetes æä¾›äº†ä¸‰ç§é…ç½®å®‰å…¨ä¸Šä¸‹æ–‡çº§åˆ«çš„æ–¹æ³•ï¼š</p>
<ul>
<li><code>Container-level Security Context</code>ï¼šä»…åº”ç”¨åˆ°æŒ‡å®šçš„å®¹å™¨</li>
<li><code>Pod-level Security Context</code>ï¼šåº”ç”¨åˆ° Pod å†…æ‰€æœ‰å®¹å™¨ä»¥åŠ Volume</li>
<li><code>Pod Security Policiesï¼ˆPSPï¼ŒåºŸå¼ƒï¼‰</code>ï¼šåº”ç”¨åˆ°é›†ç¾¤å†…éƒ¨æ‰€æœ‰ Pod ä»¥åŠ Volume</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹å‡ ç§æ–¹å¼æ¥è®¾ç½® <code>Security Context</code>ï¼š</p>
<ul>
<li>è®¿é—®æƒé™æ§åˆ¶ï¼šæ ¹æ®ç”¨æˆ· IDï¼ˆUIDï¼‰å’Œç»„ IDï¼ˆGIDï¼‰æ¥é™åˆ¶å¯¹èµ„æºï¼ˆæ¯”å¦‚ï¼šæ–‡ä»¶ï¼‰çš„è®¿é—®æƒé™</li>
<li>Security Enhanced Linux (SELinux)ï¼šä¸ºå¯¹è±¡åˆ†é… <code>SELinux</code> æ ‡ç­¾</li>
<li>ä»¥ privilegedï¼ˆç‰¹æƒï¼‰æ¨¡å¼è¿è¡Œ</li>
<li>Linux Capabilitiesï¼šç»™æŸä¸ªç‰¹å®šçš„è¿›ç¨‹è¶…çº§æƒé™ï¼Œè€Œä¸ç”¨ç»™ root ç”¨æˆ·æ‰€æœ‰çš„ privileged æƒé™</li>
<li>AppArmorï¼šä½¿ç”¨ç¨‹åºæ–‡ä»¶æ¥é™åˆ¶å•ä¸ªç¨‹åºçš„æƒé™</li>
<li>Seccompï¼šè¿‡æ»¤å®¹å™¨ä¸­è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰</li>
<li>AllowPrivilegeEscalationï¼ˆå…è®¸ç‰¹æƒæ‰©å¤§ï¼‰ï¼šæ­¤é¡¹é…ç½®æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå®šä¹‰äº†ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦å¯ä»¥æ¯”å…¶çˆ¶è¿›ç¨‹è·å¾—æ›´å¤šçš„ç‰¹æƒï¼Œç›´æ¥æ•ˆæœæ˜¯ï¼Œå®¹å™¨çš„è¿›ç¨‹ä¸Šæ˜¯å¦è¢«è®¾ç½® <code>no_new_privs</code> æ ‡è®°ã€‚å½“å‡ºç°å¦‚ä¸‹æƒ…å†µæ—¶ï¼ŒAllowPrivilegeEscalation çš„å€¼å§‹ç»ˆä¸º trueï¼š<ul>
<li>å®¹å™¨ä»¥ <code>privileged</code> æ¨¡å¼è¿è¡Œ</li>
<li>å®¹å™¨æ‹¥æœ‰ <code>CAP_SYS_ADMIN</code> çš„ Linux Capability</li>
</ul>
</li>
</ul>
<h2 id="ä¸º-Pod-è®¾ç½®-Security-Context"><a href="#ä¸º-Pod-è®¾ç½®-Security-Context" class="headerlink" title="ä¸º Pod è®¾ç½® Security Context"></a>ä¸º Pod è®¾ç½® Security Context</h2><p>æˆ‘ä»¬åªéœ€è¦åœ¨ Pod å®šä¹‰çš„èµ„æºæ¸…å•æ–‡ä»¶ä¸­æ·»åŠ  <code>securityContext</code> å­—æ®µï¼Œå°±å¯ä»¥ä¸º Pod æŒ‡å®šå®‰å…¨ä¸Šä¸‹æ–‡ç›¸å…³çš„è®¾å®šï¼Œé€šè¿‡è¯¥å­—æ®µæŒ‡å®šçš„å†…å®¹å°†ä¼šå¯¹å½“å‰ Pod ä¸­çš„æ‰€æœ‰å®¹å™¨ç”Ÿæ•ˆã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">security-context-pod-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-vol</span></span><br><span class="line">      <span class="attr">emptyDir:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">securityContext:</span></span><br><span class="line">    <span class="attr">runAsUser:</span> <span class="number">1000</span></span><br><span class="line">    <span class="attr">runAsGroup:</span> <span class="number">3000</span></span><br><span class="line">    <span class="attr">fsGroup:</span> <span class="number">2000</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-demo</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">      <span class="attr">command:</span> [<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;sleep 60m&#x27;</span>]</span><br><span class="line">      <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-vol</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/pod/demo</span></span><br><span class="line">      <span class="attr">securityContext:</span></span><br><span class="line">        <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>



<p>åœ¨å½“å‰èµ„æºæ¸…å•æ–‡ä»¶ä¸­æˆ‘ä»¬åœ¨ Pod ä¸‹é¢æ·»åŠ äº† <code>securityContext</code> å­—æ®µï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><code>runAsUser</code> å­—æ®µæŒ‡å®šäº†è¯¥ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„è¿›ç¨‹éƒ½ä»¥ UID 1000 çš„èº«ä»½è¿è¡Œ</li>
<li><code>runAsGroup</code> å­—æ®µæŒ‡å®šäº†è¯¥ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„è¿›ç¨‹éƒ½ä»¥ GID 3000 çš„èº«ä»½è¿è¡Œ<ul>
<li>å¦‚æœçœç•¥è¯¥å­—æ®µï¼Œå®¹å™¨è¿›ç¨‹çš„ GID ä¸º <code>root(0)</code></li>
<li>å®¹å™¨ä¸­åˆ›å»ºçš„æ–‡ä»¶ï¼Œå…¶æ‰€æœ‰è€…ä¸º userID 1000ï¼ŒgroupID 3000</li>
</ul>
</li>
<li><code>fsGroup</code> å­—æ®µæŒ‡å®šäº†è¯¥ Pod çš„ fsGroup ä¸º 2000<ul>
<li>æ•°æ®å· ï¼ˆå¯¹åº”æŒ‚è½½ç‚¹ <code>/pod/demo</code> çš„æ•°æ®å·ä¸º <code>sec-ctx-demo</code>ï¼‰ çš„æ‰€æœ‰è€…ä»¥åŠåœ¨è¯¥æ•°æ®å·ä¸‹åˆ›å»ºçš„ä»»ä½•æ–‡ä»¶ï¼Œå…¶ GID éƒ½ä¸º 2000</li>
</ul>
</li>
</ul>
<p>ä¸‹è¡¨æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸€äº› <code>securityContext</code> å­—æ®µè®¾ç½®å†…å®¹ä»‹ç»ï¼š</p>
<p><img src="https://picdn.youdianzhishi.com/images/1662431444209.jpg" alt="Security Context List"></p>
<p>ç›´æ¥åˆ›å»ºä¸Šé¢çš„ Pod å¯¹è±¡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl apply -f security-context-pod-demo-1.yaml</span><br><span class="line">âœ  ~ kubectl get pods</span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">security-context-pod-demo   1/1     Running   0          6m45s</span><br></pre></td></tr></table></figure>



<p>è¿è¡Œå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸‹å®¹å™¨ä¸­çš„è¿›ç¨‹è¿è¡Œçš„ ownershipï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl exec security-context-pod-demo top</span><br><span class="line">Mem: 7586020K used, 422948K free, 298660K shrd, 1247656K buff, 3867660K cached</span><br><span class="line">CPU:  2.1% usr  1.0% sys  0.0% nic 96.3% idle  0.2% io  0.0% irq  0.0% sirq</span><br><span class="line">Load average: 0.30 0.35 0.35 1/956 50</span><br><span class="line">  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND</span><br><span class="line">   46     0 1000     R     1292  0.0   0  0.0 top</span><br><span class="line">    1     0 1000     S     1280  0.0   0  0.0 sleep 60m</span><br></pre></td></tr></table></figure>



<p>æˆ‘ä»¬ç›´æ¥è¿è¡Œä¸€ä¸ª <code>top</code> è¿›ç¨‹ï¼ŒæŸ¥çœ‹å®¹å™¨ä¸­çš„æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° USER ID éƒ½ä¸º 1000ï¼ˆ<code>runAsUser</code> æŒ‡å®šçš„ï¼‰ï¼Œç„¶åæŸ¥çœ‹ä¸‹æŒ‚è½½çš„æ•°æ®å·çš„ ownershipï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl exec security-context-pod-demo -- ls -la /pod</span><br><span class="line">total 8</span><br><span class="line">drwxr-xr-x    3 root     root          4096 Nov 26 15:44 .</span><br><span class="line">drwxr-xr-x    1 root     root          4096 Nov 26 15:44 ..</span><br><span class="line">drwxrwsrwx    2 root     2000             6 Nov 26 15:43 demo</span><br></pre></td></tr></table></figure>



<p>å› ä¸ºä¸Šé¢æˆ‘ä»¬æŒ‡å®šäº† <code>fsGroup=2000</code>ï¼Œæ‰€ä»¥å£°æ˜æŒ‚è½½çš„æ•°æ®å· <code>/pod/demo</code> çš„ GID ä¹Ÿå˜æˆäº† 2000ã€‚ç›´æ¥è°ƒç”¨å®¹å™¨ä¸­çš„ id å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl exec security-context-pod-demo id</span><br><span class="line">uid=1000 gid=3000 groups=2000</span><br></pre></td></tr></table></figure>



<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° gid ä¸º 3000ï¼Œä¸ <code>runAsGroup</code> å­—æ®µæ‰€æŒ‡å®šçš„ä¸€è‡´ï¼Œå¦‚æœ <code>runAsGroup</code> å­—æ®µè¢«çœç•¥ï¼Œåˆ™ gid å–å€¼ä¸º 0ï¼ˆå³ rootï¼‰ï¼Œæ­¤æ—¶å®¹å™¨ä¸­çš„è¿›ç¨‹å°†å¯ä»¥æ“ä½œ root Group çš„æ–‡ä»¶ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬ç°åœ¨æƒ³è¦å»åˆ é™¤å®¹å™¨ä¸­çš„ <code>/tmp</code> ç›®å½•å°±æ²¡æœ‰æƒé™äº†ï¼Œå› ä¸ºè¯¥ç›®å½•çš„ç”¨æˆ·å’Œç»„éƒ½æ˜¯ rootï¼Œè€Œæˆ‘ä»¬å½“å‰è¦å»åˆ é™¤ä½¿ç”¨çš„è¿›ç¨‹çš„ ID å·å°±å˜æˆäº† 1000:3000ï¼Œæ‰€ä»¥æ²¡æœ‰æƒé™æ“ä½œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl exec security-context-pod-demo -- ls -la /tmp</span><br><span class="line">total 8</span><br><span class="line">drwxrwxrwt    2 root     root          4096 Oct 29 02:40 .</span><br><span class="line">drwxr-xr-x    1 root     root          4096 Nov 26 15:44 ..</span><br><span class="line">âœ  ~ kubectl exec security-context-pod-demo -- rm -rf /tmp</span><br><span class="line">rm: can&#x27;t remove &#x27;/tmp&#x27;: Permission denied</span><br></pre></td></tr></table></figure>



<h2 id="ä¸ºå®¹å™¨è®¾ç½®-Security-Context"><a href="#ä¸ºå®¹å™¨è®¾ç½®-Security-Context" class="headerlink" title="ä¸ºå®¹å™¨è®¾ç½® Security Context"></a>ä¸ºå®¹å™¨è®¾ç½® Security Context</h2><p>é™¤äº†åœ¨ Pod ä¸­å¯ä»¥è®¾ç½®å®‰å…¨ä¸Šä¸‹æ–‡ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å•ç‹¬ä¸ºæŸä¸ªå®¹å™¨è®¾ç½®å®‰å…¨ä¸Šä¸‹æ–‡ï¼ŒåŒæ ·ä¹Ÿæ˜¯é€šè¿‡ <code>securityContext</code> å­—æ®µè®¾ç½®ï¼Œå½“è¯¥å­—æ®µçš„é…ç½®ä¸ Pod çº§åˆ«çš„ securityContext é…ç½®ç›¸å†²çªæ—¶ï¼Œå®¹å™¨çº§åˆ«çš„é…ç½®å°†è¦†ç›– Pod çº§åˆ«çš„é…ç½®ã€‚å®¹å™¨çº§åˆ«çš„ securityContext ä¸å½±å“ Pod ä¸­çš„æ•°æ®å·ã€‚å¦‚ä¸‹èµ„æºæ¸…å•æ‰€ç¤ºï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">security-context-container-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">securityContext:</span></span><br><span class="line">    <span class="attr">runAsUser:</span> <span class="number">1000</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sec-ctx-demo</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">      <span class="attr">command:</span> [<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;sleep 60m&#x27;</span>]</span><br><span class="line">      <span class="attr">securityContext:</span></span><br><span class="line">        <span class="attr">runAsUser:</span> <span class="number">2000</span></span><br><span class="line">        <span class="attr">allowPrivilegeEscalation:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>



<p>ç›´æ¥åˆ›å»ºä¸Šé¢çš„ Pod å¯¹è±¡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl apply -f https:/www.qikqiak.com/k8strain/security/manifests/security-context-pod-demo-2.yaml</span><br><span class="line">âœ  ~ kubectl get pods</span><br><span class="line">NAME                              READY   STATUS              RESTARTS   AGE</span><br><span class="line">security-context-container-demo   1/1     Running             0          5s</span><br></pre></td></tr></table></figure>



<p>åŒæ ·æˆ‘ä»¬ç›´æ¥æ‰§è¡Œå®¹å™¨ä¸­çš„ <code>top</code> å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl exec security-context-container-demo top</span><br><span class="line">Mem: 4991896K used, 3016924K free, 52308K shrd, 158364K buff, 3282996K cached</span><br><span class="line">CPU:  2.6% usr  7.8% sys  2.6% nic 86.8% idle  0.0% io  0.0% irq  0.0% sirq</span><br><span class="line">Load average: 0.12 0.09 0.12 1/848 10</span><br><span class="line">  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND</span><br><span class="line">    6     0 2000     R     1292  0.0   1  0.0 top</span><br><span class="line">    1     0 2000     S     1280  0.0   3  0.0 sleep 60m</span><br></pre></td></tr></table></figure>



<p>å®¹å™¨çš„è¿›ç¨‹ä»¥ UID 2000 çš„èº«ä»½è¿è¡Œï¼Œè¯¥å–å€¼ç”± <code>spec.containers[*].securityContext.runAsUser</code> å®¹å™¨ç»„ä¸­çš„å­—æ®µå®šä¹‰ã€‚Pod ä¸­å®šä¹‰çš„ <code>spec.securityContext.runAsUser</code> å–å€¼ 1000 è¢«è¦†ç›–ã€‚</p>
<h2 id="è®¾ç½®-Linux-Capabilities"><a href="#è®¾ç½®-Linux-Capabilities" class="headerlink" title="è®¾ç½® Linux Capabilities"></a>è®¾ç½® Linux Capabilities</h2><p>æˆ‘ä»¬ä½¿ç”¨ <code>docker/nerdctl run</code> çš„æ—¶å€™å¯ä»¥é€šè¿‡ <code>--cap-add</code> å’Œ <code>--cap-drop</code> å‘½ä»¤æ¥ç»™å®¹å™¨æ·»åŠ  <code>Linux Capabilities</code>ã€‚é‚£ä¹ˆåœ¨ Kubernetes ä¸‹é¢å¦‚ä½•æ¥è®¾ç½®å‘¢ï¼Ÿè¦äº†è§£å¦‚ä½•è®¾ç½®ï¼Œé¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯éœ€è¦äº†è§£ä¸‹ <code>Linux Capabilities</code> æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<h3 id="Linux-Capabilities"><a href="#Linux-Capabilities" class="headerlink" title="Linux Capabilities"></a>Linux Capabilities</h3><p>è¦äº†è§£ <code>Linux Capabilities</code>ï¼Œè¿™å°±å¾—ä» Linux çš„æƒé™æ§åˆ¶å‘å±•æ¥è¯´æ˜ã€‚åœ¨ Linux 2.2 ç‰ˆæœ¬ä¹‹å‰ï¼Œå½“å†…æ ¸å¯¹è¿›ç¨‹è¿›è¡Œæƒé™éªŒè¯çš„æ—¶å€™ï¼ŒLinux å°†è¿›ç¨‹åˆ’åˆ†ä¸ºä¸¤ç±»ï¼šç‰¹æƒè¿›ç¨‹ï¼ˆUID&#x3D;0ï¼Œä¹Ÿå°±æ˜¯è¶…çº§ç”¨æˆ·ï¼‰å’Œéç‰¹æƒè¿›ç¨‹ï¼ˆUID!&#x3D;0ï¼‰ï¼Œç‰¹æƒè¿›ç¨‹æ‹¥æœ‰æ‰€æœ‰çš„å†…æ ¸æƒé™ï¼Œè€Œéç‰¹æƒè¿›ç¨‹åˆ™æ ¹æ®è¿›ç¨‹å‡­è¯ï¼ˆeffective UID, effective GIDï¼Œsupplementary group ç­‰ï¼‰è¿›è¡Œæƒé™æ£€æŸ¥ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬ä»¥å¸¸ç”¨çš„ <code>passwd</code> å‘½ä»¤ä¸ºä¾‹ï¼Œä¿®æ”¹ç”¨æˆ·å¯†ç éœ€è¦å…·æœ‰ root æƒé™ï¼Œè€Œæ™®é€šç”¨æˆ·æ˜¯æ²¡æœ‰è¿™ä¸ªæƒé™çš„ã€‚ä½†æ˜¯å®é™…ä¸Šæ™®é€šç”¨æˆ·åˆå¯ä»¥ä¿®æ”¹è‡ªå·±çš„å¯†ç ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿåœ¨ Linux çš„æƒé™æ§åˆ¶æœºåˆ¶ä¸­ï¼Œæœ‰ä¸€ç±»æ¯”è¾ƒç‰¹æ®Šçš„æƒé™è®¾ç½®ï¼Œæ¯”å¦‚ SUID(Set User ID on execution)ï¼Œå…è®¸ç”¨æˆ·ä»¥å¯æ‰§è¡Œæ–‡ä»¶çš„ owner çš„æƒé™æ¥è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚å› ä¸ºç¨‹åºæ–‡ä»¶ <code>/bin/passwd</code> è¢«è®¾ç½®äº† <code>SUID</code> æ ‡è¯†ï¼Œæ‰€ä»¥æ™®é€šç”¨æˆ·åœ¨æ‰§è¡Œ passwd å‘½ä»¤æ—¶ï¼Œè¿›ç¨‹æ˜¯ä»¥ passwd çš„æ‰€æœ‰è€…ï¼Œä¹Ÿå°±æ˜¯ root ç”¨æˆ·çš„èº«ä»½è¿è¡Œï¼Œä»è€Œå°±å¯ä»¥ä¿®æ”¹å¯†ç äº†ã€‚</p>
<p>ä½†æ˜¯ä½¿ç”¨ <code>SUID</code> å´å¸¦æ¥äº†æ–°çš„å®‰å…¨éšæ‚£ï¼Œå½“æˆ‘ä»¬è¿è¡Œè®¾ç½®äº† <code>SUID</code> çš„å‘½ä»¤æ—¶ï¼Œé€šå¸¸åªæ˜¯éœ€è¦å¾ˆå°ä¸€éƒ¨åˆ†çš„ç‰¹æƒï¼Œä½†æ˜¯ <code>SUID</code> å´ç»™äº†å®ƒ root å…·æœ‰çš„å…¨éƒ¨æƒé™ï¼Œä¸€æ—¦ è¢«è®¾ç½®äº† <code>SUID</code> çš„å‘½ä»¤å‡ºç°æ¼æ´ï¼Œæ˜¯ä¸æ˜¯å°±å¾ˆå®¹æ˜“è¢«åˆ©ç”¨äº†ã€‚</p>
<p>ä¸ºæ­¤ Linux å¼•å…¥äº† <code>Capabilities</code> æœºåˆ¶æ¥å¯¹ root æƒé™è¿›è¡Œäº†æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œå®ç°æŒ‰éœ€è¿›è¡Œæˆæƒï¼Œè¿™æ ·å°±å¤§å¤§å‡å°äº†ç³»ç»Ÿçš„å®‰å…¨éšæ‚£ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯-Capabilities"><a href="#ä»€ä¹ˆæ˜¯-Capabilities" class="headerlink" title="ä»€ä¹ˆæ˜¯ Capabilities"></a>ä»€ä¹ˆæ˜¯ Capabilities</h4><p>ä»å†…æ ¸ 2.2 å¼€å§‹ï¼ŒLinux å°†ä¼ ç»Ÿä¸Šä¸è¶…çº§ç”¨æˆ· root å…³è”çš„ç‰¹æƒåˆ’åˆ†ä¸ºä¸åŒçš„å•å…ƒï¼Œç§°ä¸º <code>capabilites</code>ã€‚<code>Capabilites</code> æ¯ä¸ªå•å…ƒéƒ½å¯ä»¥ç‹¬ç«‹å¯ç”¨å’Œç¦ç”¨ã€‚è¿™æ ·å½“ç³»ç»Ÿåœ¨ä½œæƒé™æ£€æŸ¥çš„æ—¶å€™å°±å˜æˆäº†ï¼š<strong>åœ¨æ‰§è¡Œç‰¹æƒæ“ä½œæ—¶ï¼Œå¦‚æœè¿›ç¨‹çš„æœ‰æ•ˆèº«ä»½ä¸æ˜¯ rootï¼Œå°±å»æ£€æŸ¥æ˜¯å¦å…·æœ‰è¯¥ç‰¹æƒæ“ä½œæ‰€å¯¹åº”çš„ capabilitesï¼Œå¹¶ä»¥æ­¤å†³å®šæ˜¯å¦å¯ä»¥è¿›è¡Œè¯¥ç‰¹æƒæ“ä½œ</strong>ã€‚æ¯”å¦‚å¦‚æœæˆ‘ä»¬è¦è®¾ç½®ç³»ç»Ÿæ—¶é—´ï¼Œå°±å¾—å…·æœ‰ <code>CAP_SYS_TIME</code> è¿™ä¸ª capabilitesã€‚ä¸‹é¢æ˜¯ä» <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man7/capabilities.7.html">capabilities man page</a> ä¸­æ‘˜å–çš„ capabilites åˆ—è¡¨ï¼š</p>
<p><img src="https://mudutestmenu.mudu.tv/upload/ymvrfw.jpg" alt="linux capabilities list"></p>
<h4 id="å¦‚ä½•ä½¿ç”¨-Capabilities"><a href="#å¦‚ä½•ä½¿ç”¨-Capabilities" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ Capabilities"></a>å¦‚ä½•ä½¿ç”¨ Capabilities</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>getcap</code> å’Œ <code>setcap</code> ä¸¤æ¡å‘½ä»¤æ¥åˆ†åˆ«æŸ¥çœ‹å’Œè®¾ç½®ç¨‹åºæ–‡ä»¶çš„ <code>capabilities</code> å±æ€§ã€‚æ¯”å¦‚å½“å‰æˆ‘ä»¬æ˜¯<code>test</code> è¿™ä¸ªç”¨æˆ·ï¼Œä½¿ç”¨ <code>getcap</code> å‘½ä»¤æŸ¥çœ‹ <code>ping</code> å‘½ä»¤ç›®å‰å…·æœ‰çš„ <code>capabilities</code>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ ll /bin/ping</span><br><span class="line">-rwxr-xr-x. 1 root root 66176 Aug  4  2017 /bin/ping</span><br><span class="line">âœ  ~ getcap /bin/ping</span><br><span class="line">/bin/ping = cap_net_admin,cap_net_raw+p</span><br></pre></td></tr></table></figure>



<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…·æœ‰ <code>cap_net_admin</code> è¿™ä¸ªå±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å¯ä»¥æ‰§è¡Œ <code>ping</code> å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ ping www.qikqiak.com</span><br><span class="line">PING www.qikqiak.com.w.kunlungr.com (115.223.14.186) 56(84) bytes of data.</span><br><span class="line">64 bytes from 115.223.14.186 (115.223.14.186): icmp_seq=1 ttl=54 time=7.87 ms</span><br><span class="line">64 bytes from 115.223.14.186 (115.223.14.186): icmp_seq=2 ttl=54 time=7.85 ms</span><br></pre></td></tr></table></figure>



<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æŠŠå‘½ä»¤çš„ <code>capabilities</code> å±æ€§ç§»é™¤æ‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ sudo setcap cap_net_admin,cap_net_raw-p /bin/ping</span><br><span class="line">âœ  ~ getcap /bin/ping</span><br><span class="line">/bin/ping =</span><br></pre></td></tr></table></figure>



<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰§è¡Œ <code>ping</code> å‘½ä»¤å¯ä»¥å‘ç°å·²ç»æ²¡æœ‰æƒé™äº†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ ping www.qikqiak.com</span><br><span class="line">ping: socket: Operation not permitted</span><br></pre></td></tr></table></figure>



<p>å› ä¸º ping å‘½ä»¤åœ¨æ‰§è¡Œæ—¶éœ€è¦è®¿é—®ç½‘ç»œï¼Œæ‰€éœ€çš„ <code>capabilities</code> ä¸º <code>cap_net_admin</code> å’Œ <code>cap_net_raw</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>setcap</code> å‘½ä»¤å¯æ¥æ·»åŠ å®ƒä»¬ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ sudo setcap cap_net_admin,cap_net_raw+p /bin/ping</span><br><span class="line">âœ  ~ getcap /bin/ping</span><br><span class="line">/bin/ping = cap_net_admin,cap_net_raw+p</span><br><span class="line">âœ  ~ ping www.qikqiak.com</span><br><span class="line">PING www.qikqiak.com.w.kunlungr.com (115.223.14.188) 56(84) bytes of data.</span><br><span class="line">64 bytes from 115.223.14.188 (115.223.14.188): icmp_seq=1 ttl=54 time=7.39 ms</span><br></pre></td></tr></table></figure>



<p>å‘½ä»¤ä¸­çš„ <code>p</code> è¡¨ç¤º <code>Permitted</code> é›†åˆ(æ¥ä¸‹æ¥ä¼šä»‹ç»)ï¼Œ<code>+</code> å·è¡¨ç¤ºæŠŠæŒ‡å®šçš„<code>capabilities</code> æ·»åŠ åˆ°è¿™äº›é›†åˆä¸­ï¼Œ<code>-</code> å·è¡¨ç¤ºä»é›†åˆä¸­ç§»é™¤ã€‚</p>
<p>å¯¹äºå¯æ‰§è¡Œæ–‡ä»¶çš„å±æ€§ä¸­æœ‰ä¸‰ä¸ªé›†åˆæ¥ä¿å­˜ä¸‰ç±» <code>capabilities</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>Permittedï¼šåœ¨è¿›ç¨‹æ‰§è¡Œæ—¶ï¼ŒPermitted é›†åˆä¸­çš„ capabilites è‡ªåŠ¨è¢«åŠ å…¥åˆ°è¿›ç¨‹çš„ Permitted é›†åˆä¸­ã€‚</li>
<li>Inheritableï¼šInheritable é›†åˆä¸­çš„ capabilites ä¼šä¸è¿›ç¨‹çš„ Inheritable é›†åˆæ‰§è¡Œä¸æ“ä½œï¼Œä»¥ç¡®å®šè¿›ç¨‹åœ¨æ‰§è¡Œ execve å‡½æ•°åå“ªäº› capabilites è¢«ç»§æ‰¿ã€‚</li>
<li>Effectiveï¼šEffective åªæ˜¯ä¸€ä¸ª bitã€‚å¦‚æœè®¾ç½®ä¸ºå¼€å¯ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œ execve å‡½æ•°åï¼ŒPermitted é›†åˆä¸­æ–°å¢çš„ capabilities ä¼šè‡ªåŠ¨å‡ºç°åœ¨è¿›ç¨‹çš„ Effective é›†åˆä¸­ã€‚</li>
</ul>
<p>å¯¹äºè¿›ç¨‹ä¸­æœ‰äº”ç§ <code>capabilities</code> é›†åˆç±»å‹ï¼Œç›¸æ¯”æ–‡ä»¶çš„ <code>capabilites</code>ï¼Œè¿›ç¨‹çš„ <code>capabilities</code> å¤šäº†ä¸¤ä¸ªé›†åˆï¼Œåˆ†åˆ«æ˜¯ <code>Bounding</code> å’Œ <code>Ambient</code>ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½åæ¥æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„ <code>capabilities</code> ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ cat /proc/7029/status | grep &#x27;Cap&#x27;  #7029ä¸ºPID</span><br><span class="line">CapInh: 0000000000000000</span><br><span class="line">CapPrm: 0000000000000000</span><br><span class="line">CapEff: 0000000000000000</span><br><span class="line">CapBnd: 0000001fffffffff</span><br><span class="line">CapAmb: 0000000000000000</span><br></pre></td></tr></table></figure>



<p>ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>capsh</code> å‘½ä»¤æŠŠå®ƒä»¬è½¬ä¹‰ä¸ºå¯è¯»çš„æ ¼å¼ï¼Œè¿™æ ·åŸºæœ¬å¯ä»¥çœ‹å‡ºè¿›ç¨‹å…·æœ‰çš„ <code>capabilities</code> äº†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ capsh --decode=0000001fffffffff</span><br><span class="line">0x0000001fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,35,36</span><br></pre></td></tr></table></figure>



<h3 id="Container-Runtime-Capabilities"><a href="#Container-Runtime-Capabilities" class="headerlink" title="Container Runtime Capabilities"></a>Container Runtime Capabilities</h3><p>æˆ‘ä»¬è¯´å®¹å™¨æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥ç†è®ºä¸Šå®¹å™¨å°±ä¼šå’Œè¿›ç¨‹ä¸€æ ·ä¼šæœ‰ä¸€äº›é»˜è®¤çš„å¼€æ”¾æƒé™ï¼Œé»˜è®¤æƒ…å†µä¸‹ Docker&#x2F;Containerd ä¼šåˆ é™¤å¿…é¡»çš„ <code>capabilities</code> ä¹‹å¤–çš„æ‰€æœ‰ <code>capabilities</code>ï¼Œå› ä¸ºåœ¨å®¹å™¨ä¸­æˆ‘ä»¬ç»å¸¸ä¼šä»¥ root ç”¨æˆ·æ¥è¿è¡Œï¼Œä½¿ç”¨ <code>capabilities</code> ç°åœ¨åï¼Œå®¹å™¨ä¸­çš„ä½¿ç”¨çš„ root ç”¨æˆ·æƒé™å°±æ¯”æˆ‘ä»¬å¹³æ—¶åœ¨å®¿ä¸»æœºä¸Šä½¿ç”¨çš„ root ç”¨æˆ·æƒé™è¦å°‘å¾ˆå¤šäº†ï¼Œè¿™æ ·å³ä½¿å‡ºç°äº†å®‰å…¨æ¼æ´ï¼Œä¹Ÿå¾ˆéš¾ç ´åæˆ–è€…è·å–å®¿ä¸»æœºçš„ root æƒé™ï¼Œæ‰€ä»¥ Docker&#x2F;Containerd æ”¯æŒ <code>Capabilities</code> å¯¹äºå®¹å™¨çš„å®‰å…¨æ€§æ¥è¯´æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p>
<p>ä¸è¿‡æˆ‘ä»¬åœ¨è¿è¡Œå®¹å™¨çš„æ—¶å€™å¯ä»¥é€šè¿‡æŒ‡å®š <code>--privileded</code> å‚æ•°æ¥å¼€å¯å®¹å™¨çš„è¶…çº§æƒé™ï¼Œè¿™ä¸ªå‚æ•°ä¸€å®šè¦æ…ç”¨ï¼Œå› ä¸ºä»–ä¼šè·å–ç³»ç»Ÿ root ç”¨æˆ·æ‰€æœ‰èƒ½åŠ›èµ‹å€¼ç»™å®¹å™¨ï¼Œå¹¶ä¸”ä¼šæ‰«æå®¿ä¸»æœºçš„æ‰€æœ‰è®¾å¤‡æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨ï¼Œæ‰€ä»¥æ˜¯éå¸¸å±é™©çš„æ“ä½œã€‚</p>
<p>ä½†æ˜¯å¦‚æœä½ ç¡®å®éœ€è¦ä¸€äº›ç‰¹æ®Šçš„æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>--cap-add</code> å’Œ <code>--cap-drop</code> è¿™ä¸¤ä¸ªå‚æ•°æ¥åŠ¨æ€è°ƒæ•´ï¼Œå¯ä»¥æœ€å¤§é™åº¦åœ°ä¿è¯å®¹å™¨çš„ä½¿ç”¨å®‰å…¨ã€‚ä¸‹é¢è¡¨æ ¼ä¸­åˆ—å‡ºçš„ <code>Capabilities</code> æ˜¯ Docker é»˜è®¤ç»™å®¹å™¨æ·»åŠ çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>--cap-drop</code> å»é™¤å…¶ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼š</p>
<p><img src="https://mudutestmenu.mudu.tv/upload/9bhohc.jpg" alt="docker capabilities"></p>
<p>ä¸‹é¢è¡¨æ ¼ä¸­åˆ—å‡ºçš„ <code>Capabilities</code> æ˜¯ Docker é»˜è®¤åˆ é™¤çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>--cap-add</code>æ·»åŠ å…¶ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼š</p>
<p><img src="https://mudutestmenu.mudu.tv/upload/vdjb4e.jpg" alt="docker drop capabilities"></p>
<blockquote>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--cap-add`å’Œ`--cap-drop` è¿™ä¸¤å‚æ•°éƒ½æ”¯æŒ`ALL`å€¼ï¼Œæ¯”å¦‚å¦‚æœä½ æƒ³è®©æŸä¸ªå®¹å™¨æ‹¥æœ‰é™¤äº†`MKNOD`ä¹‹å¤–çš„æ‰€æœ‰å†…æ ¸æƒé™ï¼Œé‚£ä¹ˆå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š `âœ ~ sudo docker run --cap-add=ALL --cap-drop=MKNOD ...</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ¯”å¦‚ç°åœ¨æˆ‘ä»¬éœ€è¦ä¿®æ”¹ç½‘ç»œæ¥å£æ•°æ®ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰æƒé™çš„ï¼Œå› ä¸ºéœ€è¦çš„ <code>NET_ADMIN</code> è¿™ä¸ª <code>Capabilities</code> é»˜è®¤è¢«ç§»é™¤äº†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker ä¸€æ ·çš„æ–¹å¼</span></span><br><span class="line">âœ  ~ nerdctl run -it --rm busybox /bin/sh</span><br><span class="line">/ # ip link add dummy0 type dummy</span><br><span class="line">ip: RTNETLINK answers: Operation not permitted</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>



<p>æ‰€ä»¥åœ¨ä¸ä½¿ç”¨ <code>--privileged</code> çš„æƒ…å†µä¸‹ï¼ˆä¸å»ºè®®ï¼‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>--cap-add=NET_ADMIN</code> å°†è¿™ä¸ª <code>Capabilities</code> æ·»åŠ å›æ¥ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ nerdctl run -it --rm --cap-add=NET_ADMIN busybox /bin/sh</span><br><span class="line">/ # ip link add dummy0 type dummy</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>



<p>å¯ä»¥çœ‹åˆ°å·²ç» OK äº†ã€‚</p>
<h3 id="Kubernetes-é…ç½®-Capabilities"><a href="#Kubernetes-é…ç½®-Capabilities" class="headerlink" title="Kubernetes é…ç½® Capabilities"></a>Kubernetes é…ç½® Capabilities</h3><p>ä¸Šé¢æˆ‘ä»‹ç»äº†åœ¨ Docker å®¹å™¨ä¸‹å¦‚ä½•æ¥é…ç½® <code>Capabilities</code>ï¼Œåœ¨ Kubernetes ä¸­ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ¥å®šä¹‰ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ åˆ° Pod å®šä¹‰çš„ <code>spec.containers.securityContext.capabilities</code>ä¸­å³å¯ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œ <code>add</code> å’Œ <code>drop</code> é…ç½®ï¼ŒåŒæ ·ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬è¦ç»™ busybox å®¹å™¨æ·»åŠ  <code>NET_ADMIN</code> è¿™ä¸ª <code>Capabilities</code>ï¼Œå¯¹åº”çš„ YAML æ–‡ä»¶å¯ä»¥è¿™æ ·å®šä¹‰ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cpb-demo.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cpb-demo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cpb</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">busybox</span></span><br><span class="line">      <span class="attr">args:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">sleep</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;3600&#x27;</span></span><br><span class="line">      <span class="attr">securityContext:</span></span><br><span class="line">        <span class="attr">capabilities:</span></span><br><span class="line">          <span class="attr">add:</span> <span class="comment"># æ·»åŠ </span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">NET_ADMIN</span></span><br><span class="line">          <span class="attr">drop:</span> <span class="comment"># åˆ é™¤</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">KILL</span></span><br></pre></td></tr></table></figure>



<p>æˆ‘ä»¬åœ¨ <code>securityContext</code> ä¸‹é¢æ·»åŠ äº† <code>capabilities</code> å­—æ®µï¼Œå…¶ä¸­æ·»åŠ äº† <code>NET_ADMIN</code> å¹¶ä¸”åˆ é™¤äº† <code>KILL</code> è¿™ä¸ªé»˜è®¤çš„å®¹å™¨ <code>Capabilities</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ Pod ä¸­ä¿®æ”¹ç½‘ç»œæ¥å£æ•°æ®äº†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ kubectl apply -f cpb-demo.yaml</span><br><span class="line">âœ  ~ kubectl get pods</span><br><span class="line">NAME                      READY   STATUS    RESTARTS   AGE</span><br><span class="line">cpb-demo                  1/1     Running   0          2m9s</span><br><span class="line">âœ  ~ kubectl exec -it cpb-demo /bin/sh</span><br><span class="line">/ # ip link add dummy0 type dummy</span><br><span class="line">/ #</span><br></pre></td></tr></table></figure>



<p>åœ¨ Kubernetes ä¸­é€šè¿‡ <code>containers.securityContext.capabilities</code> è¿›è¡Œé…ç½®å®¹å™¨çš„ <code>Capabilities</code>ï¼Œå½“ç„¶æœ€ç»ˆè¿˜æ˜¯é€šè¿‡å®¹å™¨è¿è¡Œæ—¶çš„ <code>libcontainer</code> å»å€ŸåŠ© <code>Linux kernel capabilities</code> å®ç°çš„æƒé™ç®¡ç†ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://example.com">å…­ä¸€</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2025/09/11/Security%20Context/">http://example.com/2025/09/11/Security%20Context/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="http://example.com" target="_blank">Hui's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BF%90%E7%BB%B4/">è¿ç»´</a><a class="post-meta__tags" href="/tags/k8s/">k8s</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/11/T%20%E7%B1%BB%E5%9E%8B/" title="T ç±»å‹"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">T ç±»å‹</div></div><div class="info-2"><div class="info-item-1">æ‚¨å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„é—®é¢˜ï¼Œå®ƒè§¦åŠäº† Go è¯­è¨€ç±»å‹ç³»ç»Ÿçš„æ ¸å¿ƒã€‚ æ ¸å¿ƒç­”æ¡ˆæ˜¯ï¼šæ˜¯çš„ï¼Œä»è¯­è¨€è¯­æ³•çš„è§’åº¦æ¥çœ‹ï¼Œå¯¹äºä»»ä½•ä¸€ä¸ªå·²å®šä¹‰çš„ç±»å‹ Tï¼Œä½ éƒ½å¯ä»¥æ„é€ å‡ºå…¶å¯¹åº”çš„æŒ‡é’ˆç±»å‹ *Tã€‚ * ç¬¦å·åœ¨ Go ä¸­æ˜¯ä¸€ä¸ªç±»å‹æ„é€ å™¨ï¼ˆType Constructorï¼‰ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯ï¼Œç»™å®šä¸€ä¸ªç±»å‹ Tï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°ç±»å‹ï¼Œè¿™ä¸ªæ–°ç±»å‹å°±æ˜¯â€œæŒ‡å‘ T çš„æŒ‡é’ˆâ€ã€‚è¿™ä¸ªè§„åˆ™æ˜¯æ™®é€‚çš„ï¼Œé€‚ç”¨äºå‡ ä¹æ‰€æœ‰ç±»å‹ã€‚  åŸç†è§£æä¸ç¤ºä¾‹è®©æˆ‘ä»¬é€šè¿‡ä¸åŒç§ç±»çš„ T æ¥éªŒè¯è¿™ä¸ªè§„åˆ™ï¼š 1. åŸºæœ¬ç±»å‹ (Basic Types)å¯¹äº int, float64, string, bool ç­‰åŸºç¡€ç±»å‹ï¼Œéƒ½å¯ä»¥åˆ›å»ºå®ƒä»¬çš„æŒ‡é’ˆç±»å‹ã€‚ 1234567var i int       // ç±»å‹ T æ˜¯ intvar p_i *int    // ç±»å‹ *T æ˜¯ *intp_i = &amp;ivar s string    // ç±»å‹ T æ˜¯ stringvar p_s *string // ç±»å‹ *T æ˜¯ *stringp_s = &amp;s  ç”¨é€”ï¼š ä¸»è¦ç”¨äºåœ¨å‡½æ•°é—´å…±äº«æˆ–ä¿®æ”¹å˜é‡çš„å€¼ã€‚ 2. å¤åˆç±»å‹ (Composite Types)...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Secret/" title="Secret"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">Secret</div></div><div class="info-2"><div class="info-item-1">Secretå‰æ–‡æˆ‘ä»¬å­¦ä¹  ConfigMap çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯´ ConfigMap è¿™ä¸ªèµ„æºå¯¹è±¡æ˜¯ Kubernetes å½“ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªèµ„æºå¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ ConfigMap æ˜¯ç”¨æ¥å­˜å‚¨ä¸€äº›éå®‰å…¨çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æœæ¶‰åŠåˆ°ä¸€äº›å®‰å…¨ç›¸å…³çš„æ•°æ®çš„è¯ç”¨ ConfigMap å°±éå¸¸ä¸å¦¥äº†ï¼Œå› ä¸º ConfigMap æ˜¯æ˜æ–‡å­˜å‚¨çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°å¦å¤–ä¸€ä¸ªèµ„æºå¯¹è±¡äº†ï¼šSecretï¼ŒSecretç”¨æ¥ä¿å­˜æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚å¯†ç ã€OAuth ä»¤ç‰Œå’Œ ssh key ç­‰ç­‰ï¼Œå°†è¿™äº›ä¿¡æ¯æ”¾åœ¨ Secret ä¸­æ¯”æ”¾åœ¨ Pod çš„å®šä¹‰ä¸­æˆ–è€… Docker é•œåƒä¸­è¦æ›´åŠ å®‰å…¨å’Œçµæ´»ã€‚ Secret ä¸»è¦ä½¿ç”¨çš„æœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼š  Opaqueï¼šbase64 ç¼–ç æ ¼å¼çš„ Secretï¼Œç”¨æ¥å­˜å‚¨å¯†ç ã€å¯†é’¥ç­‰ï¼›ä½†æ•°æ®ä¹Ÿå¯ä»¥é€šè¿‡ base64 â€“decode è§£ç å¾—åˆ°åŸå§‹æ•°æ®ï¼Œæ‰€æœ‰åŠ å¯†æ€§å¾ˆå¼±ã€‚ kubernetes.io/dockercfg: ~/.dockercfg æ–‡ä»¶çš„åºåˆ—åŒ–å½¢å¼ kubernetes.io/dockerconfigjsonï¼šç”¨æ¥å­˜å‚¨ç§æœ‰docker registryçš„è®¤è¯ä¿¡æ¯ï¼Œ~/.docker...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/09/11/k8s_11/" title="k8s_11"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">k8s_11</div></div><div class="info-2"><div class="info-item-1">æè¿°åœ¨ Kubernetes ä¸­å¦‚ä½•è¿›è¡Œå®‰å…¨é…ç½®ï¼Œå¹¶è§£é‡Šå¸¸ç”¨çš„æ–¹æ³•ã€‚ğŸ¤” åˆ†æè¿‡ç¨‹ï¼šè¯¥é—®é¢˜æ—¨åœ¨è€ƒå¯Ÿå¯¹Kubernetesç«¯åˆ°ç«¯å®‰å…¨ä½“ç³»çš„ç†è§£ï¼Œè¿™æ˜¯ä¸€ä¸ªç»¼åˆæ€§å¾ˆå¼ºçš„è¯é¢˜ã€‚ä¸€ä¸ªä¼˜ç§€çš„å›ç­”éœ€è¦ç»“æ„åŒ–åœ°å±•ç¤ºå®‰å…¨æªæ–½å¦‚ä½•åº”ç”¨äºä»åº•å±‚åŸºç¡€è®¾æ–½åˆ°åº”ç”¨ä»£ç çš„æ¯ä¸€ä¸ªå±‚é¢ã€‚ä¸šç•Œå…¬è®¤çš„â€œ4Cå®‰å…¨æ¨¡å‹â€ï¼ˆCloud, Cluster, Container, Codeï¼‰æ˜¯é˜è¿°æ­¤é—®é¢˜çš„æœ€ä½³æ¡†æ¶ã€‚æœ¬å›ç­”å°†ä»¥æ­¤æ¨¡å‹ä¸ºéª¨æ¶ï¼Œé€å±‚è§£é‡Šæ¯ä¸€ä¸ªå±‚é¢éœ€è¦å…³æ³¨çš„å®‰å…¨é…ç½®å’Œå¸¸ç”¨æ–¹æ³•ï¼Œç¡®ä¿è¦†ç›–å…¨é¢ä¸”é€»è¾‘æ¸…æ™°ã€‚ ğŸ’¡ ç­”æ¡ˆç”Ÿæˆï¼š1. æ¦‚å¿µæˆ–å®šä¹‰Kuberneteså®‰å…¨é…ç½®æ˜¯æŒ‡åœ¨Kubernetesé›†ç¾¤çš„å„ä¸ªå±‚é¢ï¼ˆåŸºç¡€è®¾æ–½ã€é›†ç¾¤ç»„ä»¶ã€å®¹å™¨ã€åº”ç”¨ä»£ç ï¼‰å®æ–½çš„ä¸€ç³»åˆ—ç­–ç•¥ã€å·¥å…·å’Œå®è·µï¼Œæ—¨åœ¨ä¿æŠ¤é›†ç¾¤åŠå…¶ä¸Šè¿è¡Œçš„åº”ç”¨å…å—æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²ã€æ¶æ„æ´»åŠ¨å’Œå…¶ä»–å®‰å…¨å¨èƒã€‚å…¶æ ¸å¿ƒåŸåˆ™æ˜¯çºµæ·±é˜²å¾¡ï¼ˆDefense in Depthï¼‰å’Œæœ€å°æƒé™åŸåˆ™ï¼ˆPrinciple of Least Privilegeï¼‰ã€‚ 2. â€œ4Câ€å®‰å…¨æ¨¡å‹ä¸å¸¸ç”¨æ–¹æ³•å±‚é¢ä¸€ï¼šCloud&#x2F;Corporate Data Center (äº‘&#x2F;åŸºç¡€è®¾æ–½å±‚)è¿™æ˜¯æœ€å¤–...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Containerd/" title="Containerd"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Containerd</div></div><div class="info-2"><div class="info-item-1">Containerd ä½¿ç”¨æˆ‘ä»¬çŸ¥é“å¾ˆæ—©ä¹‹å‰çš„ Docker Engine ä¸­å°±æœ‰äº† containerdï¼Œåªä¸è¿‡ç°åœ¨æ˜¯å°† containerd ä» Docker Engine é‡Œåˆ†ç¦»å‡ºæ¥ï¼Œä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å¼€æºé¡¹ç›®ï¼Œç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªæ›´åŠ å¼€æ”¾ã€ç¨³å®šçš„å®¹å™¨è¿è¡ŒåŸºç¡€è®¾æ–½ã€‚åˆ†ç¦»å‡ºæ¥çš„ containerd å°†å…·æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œæ¶µç›–æ•´ä¸ªå®¹å™¨è¿è¡Œæ—¶ç®¡ç†çš„æ‰€æœ‰éœ€æ±‚ï¼Œæä¾›æ›´å¼ºå¤§çš„æ”¯æŒã€‚ containerd æ˜¯ä¸€ä¸ªå·¥ä¸šçº§æ ‡å‡†çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå®ƒå¼ºè°ƒç®€å•æ€§ã€å¥å£®æ€§å’Œå¯ç§»æ¤æ€§ï¼Œcontainerd å¯ä»¥è´Ÿè´£å¹²ä¸‹é¢è¿™äº›äº‹æƒ…ï¼š  ç®¡ç†å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä»åˆ›å»ºå®¹å™¨åˆ°é”€æ¯å®¹å™¨ï¼‰ æ‹‰å–&#x2F;æ¨é€å®¹å™¨é•œåƒ å­˜å‚¨ç®¡ç†ï¼ˆç®¡ç†é•œåƒåŠå®¹å™¨æ•°æ®çš„å­˜å‚¨ï¼‰ è°ƒç”¨ runc è¿è¡Œå®¹å™¨ï¼ˆä¸ runc ç­‰å®¹å™¨è¿è¡Œæ—¶äº¤äº’ï¼‰ ç®¡ç†å®¹å™¨ç½‘ç»œæ¥å£åŠç½‘ç»œ  æ¶æ„containerd å¯ç”¨ä½œ Linux å’Œ Windows çš„å®ˆæŠ¤ç¨‹åºï¼Œå®ƒç®¡ç†å…¶ä¸»æœºç³»ç»Ÿå®Œæ•´çš„å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼Œä»é•œåƒä¼ è¾“å’Œå­˜å‚¨åˆ°å®¹å™¨æ‰§è¡Œå’Œç›‘æµ‹ï¼Œå†åˆ°åº•å±‚å­˜å‚¨åˆ°ç½‘ç»œé™„ä»¶ç­‰ç­‰ã€‚  ä¸Šå›¾æ˜¯ containerd å®˜æ–¹æä¾›çš„æ¶æ„å›¾ï¼Œå¯ä»¥çœ‹å‡º containerd é‡‡ç”¨çš„ä¹Ÿæ˜¯ C&#x2F;S æ¶æ„ï¼Œ...</div></div></div></a><a class="pagination-related" href="/2025/09/11/k8s_12/" title="k8s_12"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">k8s_12</div></div><div class="info-2"><div class="info-item-1">å¦‚ä½•åœ¨ Kubernetes ä¸­å®ç°æœåŠ¡çš„è‡ªåŠ¨ä¼¸ç¼©ï¼ˆautoscalingï¼‰ï¼ŸOf course. Automating the scaling of services is one of Kubernetesâ€™ most powerful features, enabling applications to be both resilient to traffic spikes and cost-effective during quiet periods. This is achieved through a combination of several components. ğŸ¤” åˆ†æè¿‡ç¨‹ï¼šè¯¥é—®é¢˜æ—¨åœ¨è€ƒå¯Ÿå¯¹Kubernetesæ ¸å¿ƒåŠ¨æ€ç®¡ç†èƒ½åŠ›çš„ç†è§£ã€‚ä¸€ä¸ªå…¨é¢çš„å›ç­”ä¸èƒ½åªæåŠä¸€ç§è‡ªåŠ¨ä¼¸ç¼©æ–¹å¼ï¼Œè€Œåº”ç»“æ„åŒ–åœ°ä»‹ç»Kubernetesä¸­ä¸‰ä¸ªä¸»è¦å±‚æ¬¡çš„è‡ªåŠ¨ä¼¸ç¼©å™¨ï¼šHPA (æ°´å¹³), VPA (å‚ç›´), å’Œ CA (é›†ç¾¤)ã€‚å›ç­”çš„é‡ç‚¹åœ¨äºé˜æ˜æ¯ç§ä¼¸ç¼©å™¨çš„è§¦å‘æœºåˆ¶ã€ä½œç”¨èŒƒå›´å’Œå…¸å‹ç”¨ä¾‹ï¼Œå¹¶è§£é‡Šå®ƒä»¬å¦‚ä½•ååŒå·¥ä½œï¼Œå…±åŒæ„å»ºä¸€ä¸ªå¼¹æ€§çš„ã€èµ„æºé«˜æ•ˆçš„ç³»ç»Ÿã€‚ ğŸ’¡ ç­”æ¡ˆç”Ÿæˆï¼š1. æ¦‚å¿µæˆ–å®šä¹‰Kube...</div></div></div></a><a class="pagination-related" href="/2025/09/11/HPA/" title="HPA"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">HPA</div></div><div class="info-2"><div class="info-item-1">HPA æ§åˆ¶å™¨åœ¨å‰é¢çš„å­¦ä¹ ä¸­æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª kubectl scale å‘½ä»¤å¯ä»¥æ¥å®ç° Pod çš„æ‰©ç¼©å®¹åŠŸèƒ½ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯å®Œå…¨æ‰‹åŠ¨æ“ä½œçš„ï¼Œè¦åº”å¯¹çº¿ä¸Šçš„å„ç§å¤æ‚æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿåšåˆ°è‡ªåŠ¨åŒ–å»æ„ŸçŸ¥ä¸šåŠ¡ï¼Œæ¥è‡ªåŠ¨è¿›è¡Œæ‰©ç¼©å®¹ã€‚ä¸ºæ­¤ï¼ŒKubernetes ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·çš„ä¸€ä¸ªèµ„æºå¯¹è±¡ï¼šHorizontal Pod Autoscalingï¼ˆPod æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©ï¼‰ï¼Œç®€ç§° HPAï¼ŒHPA é€šè¿‡ç›‘æ§åˆ†æä¸€äº›æ§åˆ¶å™¨æ§åˆ¶çš„æ‰€æœ‰ Pod çš„è´Ÿè½½å˜åŒ–æƒ…å†µæ¥ç¡®å®šæ˜¯å¦éœ€è¦è°ƒæ•´ Pod çš„å‰¯æœ¬æ•°é‡ï¼Œè¿™æ˜¯ HPA æœ€åŸºæœ¬çš„åŸç†ï¼š  æˆ‘ä»¬å¯ä»¥ç®€å•çš„é€šè¿‡ kubectl autoscale å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ª HPA èµ„æºå¯¹è±¡ï¼ŒHPA Controller é»˜è®¤30sè½®è¯¢ä¸€æ¬¡ï¼ˆå¯é€šè¿‡ kube-controller-manager çš„--horizontal-pod-autoscaler-sync-period å‚æ•°è¿›è¡Œè®¾ç½®ï¼‰ï¼ŒæŸ¥è¯¢æŒ‡å®šçš„èµ„æºä¸­çš„ Pod èµ„æºä½¿ç”¨ç‡ï¼Œå¹¶ä¸”ä¸åˆ›å»ºæ—¶è®¾å®šçš„å€¼å’ŒæŒ‡æ ‡åšå¯¹æ¯”ï¼Œä»è€Œå®ç°è‡ªåŠ¨ä¼¸ç¼©çš„åŠŸèƒ½ã€‚ Metrics Serveråœ¨ HPA çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ Heapster æä¾› CPU...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Thanos%20Querier/" title="Thanos Querier"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Thanos Querier</div></div><div class="info-2"><div class="info-item-1">Querier ç»„ä»¶ç°åœ¨æˆ‘ä»¬å°±åˆ›å»ºæˆåŠŸäº†ä¸¤ä¸ª Prometheus å®ä¾‹ï¼Œä½†æ˜¯æˆ‘ä»¬çœŸæ­£å»ä½¿ç”¨çš„æ—¶å€™å¹¶ä¸æ˜¯åƒä¸Šé¢æåˆ°çš„åœ¨å‰é¢åŠ ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨å»æŸ¥è¯¢ç›‘æ§æ•°æ®ï¼Œè€Œæ˜¯ä½¿ç”¨ Thanos çš„ Querier ç»„ä»¶æ¥æä¾›ä¸€ä¸ªå…¨å±€çš„ç»Ÿä¸€æŸ¥è¯¢å…¥å£ã€‚å¯¹äº Quierier æœ€é‡è¦çš„å°±æ˜¯è¦é…ç½®ä¸Š Thanos çš„ Sidecar åœ°å€ï¼Œæˆ‘ä»¬è¿™é‡Œå®Œå…¨å¯ä»¥ç›´æ¥ä½¿ç”¨ Headless Service å»è‡ªåŠ¨å‘ç°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677# thanos-querier.yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: thanos-querier  namespace: kube-mon  labels:    app: thanos-querierspec:  replicas:...</div></div></div></a><a class="pagination-related" href="/2025/09/11/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%8F%AF%E8%A7%82%E6%B5%8B%E5%B9%B3%E5%8F%B0%20OpenObserve/" title="äº‘åŸç”Ÿå¯è§‚æµ‹å¹³å° OpenObserve"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">äº‘åŸç”Ÿå¯è§‚æµ‹å¹³å° OpenObserve</div></div><div class="info-2"><div class="info-item-1">äº‘åŸç”Ÿå¯è§‚æµ‹å¹³å° OpenObserveOpenObserveï¼ˆç®€ç§° O2ï¼‰æ˜¯ä¸€ä¸ªç”¨ Rust å¼€å‘çš„å¼€æºäº‘åŸç”Ÿå¯è§‚æµ‹å¹³å°ï¼Œä¸“ä¸ºæ—¥å¿—ã€æŒ‡æ ‡ã€è¿½è¸ªè€Œæ„å»ºï¼Œè®¾è®¡ç”¨äº PB çº§å·¥ä½œã€‚  ä¸éœ€è¦ç†è§£å’Œè°ƒæ•´å¤§é‡é…ç½®ç½®çš„ Elasticsearch ç›¸æ¯”ï¼Œå®ƒç®€å•ä¸”æ˜“äºæ“ä½œã€‚åœ¨ 2 åˆ†é’Ÿå†…å³å¯å¯åŠ¨å¹¶è¿è¡Œ OpenObserveã€‚å¯¹äºä½¿ç”¨ API è·å–æ•°æ®å¹¶æ‰§è¡Œæœç´¢çš„ç”¨æˆ·æ¥è¯´ï¼ŒOpenObserve å¯ä»¥æ— ç¼æ›¿ä»£ Elasticsearchã€‚OpenObserve å¸¦æœ‰è‡ªå·±çš„ç”¨æˆ·ç•Œé¢ï¼Œæ— éœ€å•ç‹¬å®‰è£…ã€‚ä¸ Elasticsearch ç›¸æ¯”ï¼Œä½¿ç”¨ OpenObserve å¯ä»¥å°†æ—¥å¿—å­˜å‚¨æˆæœ¬é™ä½çº¦ 140 å€ã€‚  ç›¸å…³æ¦‚å¿µåœ¨è¯¦ç»†äº†è§£ O2 ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›ç›¸å…³æ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µæ˜¯ O2 çš„åŸºç¡€ã€‚ Organizationsï¼ˆç»„ç»‡ï¼‰ ç»„ç»‡æ˜¯ OpenObserve ä¸­å¯¹å„ç§æµã€ç”¨æˆ·ã€åŠŸèƒ½è¿›è¡Œåˆ†ç»„çš„é€»è¾‘å®ä½“ã€‚ç»„ç»‡å¯ä»¥ä»£è¡¨ä¸€ä¸ªä¼ä¸šã€ä¼ä¸šçš„ä¸€ä¸ªéƒ¨é—¨æˆ–ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚æ‰€æœ‰æµã€ç”¨æˆ·ã€åŠŸèƒ½ç­‰éƒ½é™å®šåœ¨ä¸€ä¸ªç»„ç»‡èŒƒå›´å†…ã€‚ Streamsï¼ˆæµï¼‰ OpenObserve ä¸­çš„æµæ˜¯å…±äº«ç›¸åŒæºçš„äº‹ä»¶åºåˆ—ï¼ˆæ—¥å¿—&#x2F;æŒ‡æ ‡&#x...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">å…­ä¸€</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">274</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">45</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Security-Context"><span class="toc-number">1.</span> <span class="toc-text">Security Context</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA-Pod-%E8%AE%BE%E7%BD%AE-Security-Context"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸º Pod è®¾ç½® Security Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%AE%BE%E7%BD%AE-Security-Context"><span class="toc-number">1.2.</span> <span class="toc-text">ä¸ºå®¹å™¨è®¾ç½® Security Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE-Linux-Capabilities"><span class="toc-number">1.3.</span> <span class="toc-text">è®¾ç½® Linux Capabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-Capabilities"><span class="toc-number">1.3.1.</span> <span class="toc-text">Linux Capabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Capabilities"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯ Capabilities</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Capabilities"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">å¦‚ä½•ä½¿ç”¨ Capabilities</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Container-Runtime-Capabilities"><span class="toc-number">1.3.2.</span> <span class="toc-text">Container Runtime Capabilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kubernetes-%E9%85%8D%E7%BD%AE-Capabilities"><span class="toc-number">1.3.3.</span> <span class="toc-text">Kubernetes é…ç½® Capabilities</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/27/hexo-beautify/" title="Hexo åšå®¢ç¾åŒ–ç¬”è®°ï¼šä»é›¶æ­å»ºé«˜é¢œå€¼æŠ€æœ¯åšå®¢">Hexo åšå®¢ç¾åŒ–ç¬”è®°ï¼šä»é›¶æ­å»ºé«˜é¢œå€¼æŠ€æœ¯åšå®¢</a><time datetime="2026-02-27T04:00:00.000Z" title="å‘è¡¨äº 2026-02-27 12:00:00">2026-02-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/Jenkens-Blue%20Ocean%20%E6%8F%92%E4%BB%B6/" title="Jenkins Blue Ocean">Jenkins Blue Ocean</a><time datetime="2025-09-11T12:42:57.000Z" title="å‘è¡¨äº 2025-09-11 20:42:57">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/jenkins-jenkinsfile/" title="Jenkins Jenkinsfile">Jenkins Jenkinsfile</a><time datetime="2025-09-11T12:40:44.000Z" title="å‘è¡¨äº 2025-09-11 20:40:44">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/shell-trap/" title="Linux-trap">Linux-trap</a><time datetime="2025-09-11T12:40:44.000Z" title="å‘è¡¨äº 2025-09-11 20:40:44">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/shell-%E6%95%B0%E7%BB%84/" title="Shell-æ•°ç»„">Shell-æ•°ç»„</a><time datetime="2025-09-11T12:40:44.000Z" title="å‘è¡¨äº 2025-09-11 20:40:44">2025-09-11</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By å…­ä¸€</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body></html>
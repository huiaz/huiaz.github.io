<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Jenkins Jenkinsfile | Hui's Blog</title><meta name="author" content="六一"><meta name="copyright" content="六一"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Jenkinsfile 的基本类型Jenkins Pipeline 目前支持两种语法类型：  Declarative Pipeline (声明式流水线) - 推荐：  结构化、更容易阅读和编写。 强制遵循特定语法，限制了某些 Groovy 结构的使用，但通常更不易出错。 适合大多数 CI&#x2F;CD 场景。 以 pipeline &#123; ... &#125; 块开始。   Scripte">
<meta property="og:type" content="article">
<meta property="og:title" content="Jenkins Jenkinsfile">
<meta property="og:url" content="https://huiaz.github.io/2025/09/11/jenkins-jenkinsfile/index.html">
<meta property="og:site_name" content="Hui&#39;s Blog">
<meta property="og:description" content="Jenkinsfile 的基本类型Jenkins Pipeline 目前支持两种语法类型：  Declarative Pipeline (声明式流水线) - 推荐：  结构化、更容易阅读和编写。 强制遵循特定语法，限制了某些 Groovy 结构的使用，但通常更不易出错。 适合大多数 CI&#x2F;CD 场景。 以 pipeline &#123; ... &#125; 块开始。   Scripte">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://huiaz.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-09-11T12:40:44.000Z">
<meta property="article:modified_time" content="2025-09-11T13:42:19.288Z">
<meta property="article:author" content="六一">
<meta property="article:tag" content="运维">
<meta property="article:tag" content="DevOps">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://huiaz.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Jenkins Jenkinsfile",
  "url": "https://huiaz.github.io/2025/09/11/jenkins-jenkinsfile/",
  "image": "https://huiaz.github.io/img/butterfly-icon.png",
  "datePublished": "2025-09-11T12:40:44.000Z",
  "dateModified": "2025-09-11T13:42:19.288Z",
  "author": [
    {
      "@type": "Person",
      "name": "六一",
      "url": "https://huiaz.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://huiaz.github.io/2025/09/11/jenkins-jenkinsfile/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Jenkins Jenkinsfile',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">274</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">45</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hui's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Jenkins Jenkinsfile</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Jenkins Jenkinsfile</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-11T13:42:19.288Z" title="更新于 2025-09-11 21:42:19">2025-09-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/DevOps/">DevOps</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/DevOps/Jenkins/">Jenkins</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h3 id="Jenkinsfile-的基本类型"><a href="#Jenkinsfile-的基本类型" class="headerlink" title="Jenkinsfile 的基本类型"></a>Jenkinsfile 的基本类型</h3><p>Jenkins Pipeline 目前支持两种语法类型：</p>
<ol>
<li><p><strong>Declarative Pipeline (声明式流水线) - 推荐：</strong></p>
<ul>
<li>结构化、更容易阅读和编写。</li>
<li>强制遵循特定语法，限制了某些 Groovy 结构的使用，但通常更不易出错。</li>
<li>适合大多数 CI&#x2F;CD 场景。</li>
<li>以 <code>pipeline &#123; ... &#125;</code> 块开始。</li>
</ul>
</li>
<li><p><strong>Scripted Pipeline (脚本式流水线) - 更灵活，但复杂：</strong></p>
<ul>
<li>基于传统的 Groovy 脚本。</li>
<li>提供了 Groovy 语言的完整能力，允许更复杂的逻辑和自定义行为。</li>
<li>学习曲线陡峭，调试难度大，更易出错。</li>
<li>以 <code>node &#123; ... &#125;</code> 块开始（或直接是 Groovy 脚本）。</li>
<li>通常用于声明式流水线无法满足的非常特定和高级的场景，或者作为共享库的一部分。</li>
</ul>
</li>
</ol>
<p>除非有特殊需求，<strong>强烈推荐使用 Declarative Pipeline</strong>。以下结构将主要围绕 Declarative Pipeline 展开。</p>
<hr>
<h3 id="Jenkinsfile-Declarative-Pipeline-的基本结构"><a href="#Jenkinsfile-Declarative-Pipeline-的基本结构" class="headerlink" title="Jenkinsfile (Declarative Pipeline) 的基本结构"></a>Jenkinsfile (Declarative Pipeline) 的基本结构</h3><p>一个典型的 Declarative <code>Jenkinsfile</code> 包含以下核心部分：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这是一个声明式 Jenkinsfile 示例</span></span><br><span class="line"></span><br><span class="line">pipeline &#123; <span class="comment">// 1. `pipeline` 块：所有声明式 Pipeline 的根</span></span><br><span class="line">  </span><br><span class="line">    agent any <span class="comment">// 2. `agent` 部分：定义在哪台机器（Agent/Node）上运行流水线</span></span><br><span class="line"></span><br><span class="line">    options &#123; <span class="comment">// 3. `options` 部分：配置整个流水线的选项</span></span><br><span class="line">        timestamps() <span class="comment">// 在控制台输出中显示时间戳</span></span><br><span class="line">        skipDefaultCheckout(<span class="literal">true</span>) <span class="comment">// 跳过默认的 SCM 检出（如果自己处理检出）</span></span><br><span class="line">        <span class="comment">// retry(3) // 失败时重试3次</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    environment &#123; <span class="comment">// 4. `environment` 部分：定义环境变量</span></span><br><span class="line">        <span class="comment">// 可以在流水线或特定阶段中访问</span></span><br><span class="line">        DOCKER_IMAGE_NAME = <span class="string">&quot;my-app&quot;</span></span><br><span class="line">        DOCKER_REGISTRY = <span class="string">&quot;your.docker.registry.com&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tools &#123; <span class="comment">// 5. `tools` 部分：自动安装工具（如 Maven, JDK, Node.js）</span></span><br><span class="line">        <span class="comment">// 确保 Jenkins 管理 -&gt; 全局工具配置 中已配置这些工具</span></span><br><span class="line">        maven <span class="string">&#x27;Maven 3.8.6&#x27;</span> <span class="comment">// Maven 3.8.6 的预定义名称</span></span><br><span class="line">        jdk <span class="string">&#x27;OpenJDK 11&#x27;</span>   <span class="comment">// OpenJDK 11 的预定义名称</span></span><br><span class="line">        nodejs <span class="string">&#x27;node-16&#x27;</span>   <span class="comment">// Node.js 16 的预定义名称</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stages &#123; <span class="comment">// 6. `stages` 部分：定义流水线的阶段集合</span></span><br><span class="line">      </span><br><span class="line">        stage(<span class="string">&#x27;Checkout&#x27;</span>) &#123; <span class="comment">// 7. `stage` 块：定义一个逻辑阶段</span></span><br><span class="line">            steps &#123; <span class="comment">// 8. `steps` 块：定义阶段内的具体步骤</span></span><br><span class="line">                <span class="comment">// `sh` 用于执行 Shell 命令 (Linux/macOS)</span></span><br><span class="line">                <span class="comment">// `bat` 用于执行 Batch 命令 (Windows)</span></span><br><span class="line">                <span class="comment">// `script` 用于执行更复杂的 Groovy 脚本块</span></span><br><span class="line">                <span class="comment">// `git` 用于 SCM 检出</span></span><br><span class="line">              </span><br><span class="line">                script &#123;</span><br><span class="line">                    echo <span class="string">&quot;Checking out Git repository...&quot;</span></span><br><span class="line">                    <span class="comment">// 尽管有 skipDefaultCheckout，这里演示手动检出</span></span><br><span class="line">                    git <span class="attr">branch:</span> <span class="string">&#x27;main&#x27;</span>, <span class="attr">credentialsId:</span> <span class="string">&#x27;your-git-cred-id&#x27;</span>, <span class="attr">url:</span> <span class="string">&#x27;https://github.com/your-org/your-repo.git&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">&#x27;Build&#x27;</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">&quot;Building the application...&quot;</span></span><br><span class="line">                sh <span class="string">&#x27;mvn clean package -DskipTests&#x27;</span> <span class="comment">// 调用 Maven 构建</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">&#x27;Test&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// `when` 子句：定义阶段执行的条件</span></span><br><span class="line">            when &#123;</span><br><span class="line">                expression &#123; env.BRANCH_NAME == <span class="string">&#x27;main&#x27;</span> || env.BRANCH_NAME.startsWith(<span class="string">&#x27;feature/&#x27;</span>) &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">&quot;Running unit tests...&quot;</span></span><br><span class="line">                sh <span class="string">&#x27;mvn test&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">&#x27;Build Docker Image&#x27;</span>) &#123;</span><br><span class="line">            environment &#123; <span class="comment">// 可以在阶段级别定义环境变量，覆盖或新增</span></span><br><span class="line">                IMAGE_TAG = <span class="string">&quot;$&#123;DOCKER_REGISTRY&#125;/$&#123;DOCKER_IMAGE_NAME&#125;:$&#123;env.BUILD_NUMBER&#125;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">&quot;Building Docker image: $&#123;IMAGE_TAG&#125;&quot;</span></span><br><span class="line">                script &#123;</span><br><span class="line">                    <span class="comment">// withCredentials 块用于安全地使用 Jenkins 凭据</span></span><br><span class="line">                    withCredentials([usernamePassword(<span class="attr">credentialsId:</span> <span class="string">&#x27;docker-registry-credentials&#x27;</span>, <span class="attr">passwordVariable:</span> <span class="string">&#x27;DOCKER_PASSWORD&#x27;</span>, <span class="attr">usernameVariable:</span> <span class="string">&#x27;DOCKER_USERNAME&#x27;</span>)]) &#123;</span><br><span class="line">                        sh <span class="string">&quot;docker login -u $&#123;DOCKER_USERNAME&#125; -p $&#123;DOCKER_PASSWORD&#125; $&#123;DOCKER_REGISTRY&#125;&quot;</span></span><br><span class="line">                        sh <span class="string">&quot;docker build -t $&#123;IMAGE_TAG&#125; .&quot;</span></span><br><span class="line">                        sh <span class="string">&quot;docker push $&#123;IMAGE_TAG&#125;&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">&#x27;Deploy to Dev&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// `agent` 也可以在阶段级别指定，覆盖顶层定义</span></span><br><span class="line">            agent &#123; label <span class="string">&#x27;kubernetes-kubectl-agent&#x27;</span> &#125; <span class="comment">// 假设需要一个带 kubectl 的 Agent</span></span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">&quot;Deploying to development environment...&quot;</span></span><br><span class="line">                <span class="comment">// 确保 kubectl-agent 拥有部署到 K8s 的权限</span></span><br><span class="line">                sh <span class="string">&quot;kubectl apply -f k8s/dev-deployment.yaml --namespace dev --set image.tag=$&#123;env.BUILD_NUMBER&#125;&quot;</span></span><br><span class="line">                sh <span class="string">&quot;kubectl rollout status deployment/my-app-dev -n dev&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">&#x27;Approve for Prod&#x27;</span>) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                expression &#123; env.BRANCH_NAME == <span class="string">&#x27;main&#x27;</span> &#125; <span class="comment">// 只有主分支才能触发生产部署</span></span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                <span class="comment">// `input` 步骤：在流水线中暂停并等待用户确认</span></span><br><span class="line">                script &#123;</span><br><span class="line">                    timeout(<span class="attr">time:</span> <span class="number">1</span>, <span class="attr">unit:</span> <span class="string">&#x27;HOURS&#x27;</span>) &#123; <span class="comment">// 等待审批最多1小时</span></span><br><span class="line">                        input <span class="attr">message:</span> <span class="string">&#x27;Approve deployment to Production?&#x27;</span>, <span class="attr">ok:</span> <span class="string">&#x27;Deploy&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">&#x27;Deploy to Prod&#x27;</span>) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                expression &#123; env.BRANCH_NAME == <span class="string">&#x27;main&#x27;</span> &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            agent &#123; label <span class="string">&#x27;kubernetes-prod-agent&#x27;</span> &#125; <span class="comment">// 假设生产环境是用不同的 Agent</span></span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">&quot;Deploying to production environment...&quot;</span></span><br><span class="line">                sh <span class="string">&quot;kubectl apply -f k8s/prod-deployment.yaml --namespace prod --set image.tag=$&#123;env.BUILD_NUMBER&#125;&quot;</span></span><br><span class="line">                sh <span class="string">&quot;kubectl rollout status deployment/my-app-prod -n prod&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    post &#123; <span class="comment">// 9. `post` 部分：定义流水线结束后执行的动作 (无论成功失败)</span></span><br><span class="line">        always &#123; <span class="comment">// 总是执行</span></span><br><span class="line">            echo <span class="string">&#x27;Archiving build artifacts...&#x27;</span></span><br><span class="line">            archiveArtifacts <span class="attr">artifacts:</span> <span class="string">&#x27;target/*.jar&#x27;</span>, <span class="attr">fingerprint:</span> <span class="literal">true</span> <span class="comment">// 归档构建产物</span></span><br><span class="line">          </span><br><span class="line">            <span class="comment">// 发送通知</span></span><br><span class="line">            <span class="comment">// mail to: &#x27;devops@example.com&#x27;, subject: &quot;Build $&#123;currentBuild.fullDisplayName&#125; finished&quot;, body: &quot;Status: $&#123;currentBuild.result&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        success &#123; <span class="comment">// 流水线成功时执行</span></span><br><span class="line">            echo <span class="string">&#x27;Pipeline finished successfully!&#x27;</span></span><br><span class="line">            <span class="comment">// slackSend channel: &#x27;#devops-alerts&#x27;, message: &quot;Build $&#123;currentBuild.displayName&#125; SUCCESS!&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        failure &#123; <span class="comment">// 流水线失败时执行</span></span><br><span class="line">            echo <span class="string">&#x27;Pipeline failed!&#x27;</span></span><br><span class="line">            <span class="comment">// slackSend channel: &#x27;#devops-alerts&#x27;, message: &quot;Build $&#123;currentBuild.displayName&#125; FAILED! See $&#123;env.BUILD_URL&#125;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        unstable &#123; <span class="comment">// 流水线不稳定时（例如测试失败但构建成功）执行</span></span><br><span class="line">            echo <span class="string">&#x27;Pipeline is unstable.&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        changed &#123; <span class="comment">// 构建状态发生变化时（从成功到失败，或失败到成功等）</span></span><br><span class="line">            echo <span class="string">&#x27;Build status changed.&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="关键组成部分解释："><a href="#关键组成部分解释：" class="headerlink" title="关键组成部分解释："></a>关键组成部分解释：</h4><ol>
<li><p>**<code>pipeline &#123; ... &#125;</code>**：</p>
<ul>
<li>外部的根块，所有声明式流水线都必须包含这个块。</li>
</ul>
</li>
<li><p>**<code>agent &#123; ... &#125;</code>**：</p>
<ul>
<li><strong>定义执行流水线的 Jenkins Agent（或节点）。</strong></li>
<li><code>agent any</code>：在任何可用的 Agent 上运行。</li>
<li><code>agent none</code>：不为整个流水线分配 Agent，每个 <code>stage</code> 必须自己指定 <code>agent</code>。</li>
<li><code>agent &#123; label &#39;your-label&#39; &#125;</code>：在具有特定标签的 Agent 上运行。</li>
<li><code>agent &#123; node &#123; label &#39;node-name&#39; &#125; &#125;</code>：在名为 <code>node-name</code> 的特定 Agent 上运行。</li>
<li><code>agent &#123; docker &#123; image &#39;maven:3-alpine&#39; &#125; &#125;</code>：在 Docker 容器中运行（需安装 Docker Pipeline 插件）。</li>
<li><code>agent &#123; kubernetes &#123; ... &#125; &#125;</code>：在 Kubernetes Pod 中运行（需安装 Kubernetes 插件）。</li>
</ul>
</li>
<li><p>**<code>options &#123; ... &#125;</code>**：</p>
<ul>
<li>用于配置流水线的各种选项，如：<ul>
<li><code>timestamps()</code>：在控制台输出中显示时间戳。</li>
<li><code>retry(N)</code>：当流水线失败时，重新尝试 N 次。</li>
<li><code>timeout(time: N, unit: &#39;HOURS&#39;)</code>：设置流水线或阶段的整体超时。</li>
<li><code>skipDefaultCheckout(true)</code>：跳过 Jenkins 默认在开始时执行的 SCM 检出。</li>
<li><code>disableConcurrentBuilds()</code>：阻止相同流水线的并发构建。</li>
</ul>
</li>
</ul>
</li>
<li><p>**<code>environment &#123; ... &#125;</code>**：</p>
<ul>
<li>定义可以在整个流水线中访问的环境变量。</li>
<li>变量可以通过 <code>$&#123;VAR_NAME&#125;</code> 或 <code>env.VAR_NAME</code> 访问。</li>
<li>可以包含 <code>credentials()</code> 这样的凭据绑定，安全地将 Jenkins 凭据暴露为环境变量。</li>
</ul>
</li>
<li><p>**<code>tools &#123; ... &#125;</code>**：</p>
<ul>
<li>自动安装和配置构建工具（如 Maven、JDK、Node.js）。</li>
<li>需要在 Jenkins 的 <code>Manage Jenkins</code> -&gt; <code>Global Tool Configuration</code> 中预先配置这些工具的名称和版本。</li>
</ul>
</li>
<li><p>**<code>stages &#123; ... &#125;</code>**：</p>
<ul>
<li>包含所有 <code>stage</code> 的集合。流水线通常由多个顺序执行的阶段组成。</li>
</ul>
</li>
<li><p>**<code>stage(&#39;Name&#39;) &#123; ... &#125;</code>**：</p>
<ul>
<li>定义一个逻辑上的流水线阶段，例如 <code>Build</code>、<code>Test</code>、<code>Deploy</code>。</li>
<li>每个阶段都包含一个 <code>steps</code> 块。</li>
<li>可以包含自身的 <code>agent</code>、<code>options</code>、<code>environment</code> 和 <code>when</code>。</li>
</ul>
</li>
<li><p>**<code>steps &#123; ... &#125;</code>**：</p>
<ul>
<li>定义在当前 <code>stage</code> 中执行的所有具体操作。</li>
<li>常用的步骤类型：<ul>
<li><code>sh &#39;command&#39;</code>：在 Agent 上执行 Shell 命令。</li>
<li><code>bat &#39;command&#39;</code>：在 Windows Agent 上执行 Batch 命令。</li>
<li><code>script &#123; ... &#125;</code>：在声明式流水线中执行更复杂的 Groovy 脚本逻辑。</li>
<li><code>git branch: &#39;main&#39;, url: &#39;...&#39;</code>：执行 Git 检出。</li>
<li><code>input message: &#39;...&#39;</code>：在流水线执行中暂停，等待用户输入或确认。</li>
<li><code>archiveArtifacts artifacts: &#39;...&#39;</code>：归档构建产物。</li>
<li><code>junit &#39;...&#39;</code>：发布 JUnit 测试报告。</li>
<li><code>slackSend channel: &#39;...&#39;</code>：发送 Slack 消息（需安装插件）。</li>
<li><code>withCredentials([usernamePassword(...)])&#123;...&#125;</code>：安全地使用 Jenkins 凭据。</li>
</ul>
</li>
</ul>
</li>
<li><p>**<code>post &#123; ... &#125;</code>**：</p>
<ul>
<li>定义在流水线或阶段执行完成后运行的动作，无论成功、失败、不稳定或总是执行。</li>
<li>常见的条件：<code>always</code>、<code>success</code>、<code>failure</code>、<code>unstable</code>、<code>changed</code>、<code>fixed</code>。</li>
</ul>
</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>Jenkinsfile</code> 是实现 Jenkins <strong>Pipeline as Code</strong> 的核心。它将 CI&#x2F;CD 流水线定义显式化、版本化，并与您的项目代码紧密结合，从而提供了更高的可追溯性、标准化和团队协作效率。理解其基本结构和各部分的用途，是您构建和管理现代 CI&#x2F;CD 流程的关键一步。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://huiaz.github.io">六一</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://huiaz.github.io/2025/09/11/jenkins-jenkinsfile/">https://huiaz.github.io/2025/09/11/jenkins-jenkinsfile/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://huiaz.github.io" target="_blank">Hui's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BF%90%E7%BB%B4/">运维</a><a class="post-meta__tags" href="/tags/DevOps/">DevOps</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/11/shell-trap/" title="Linux-trap"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Linux-trap</div></div><div class="info-2"><div class="info-item-1">——— | :——- | :———————————————————– || EXIT    | 0        | 伪信号 (Pseudo-Signal)。这不是一个真正的 OS 信号，而是 Shell 脚本在任何方式退出时都会触发的特殊陷阱。这是进行通用清理工作的最佳选择。 || SIGINT  | 2        | **中断信号 (Interrupt)**。通常由用户按下 Ctrl+C 触发。用于处理用户手动中断脚本的场景。 || SIGTERM | 15       | **终止信号 (Terminate)**。这是标准的、优雅的程序终止信号，例如 kill &lt;pid&gt; 命令默认发送的就是这个信号。服务管理工具（如 systemd）也用它来停止服务。 || SIGHUP  | 1        | **挂起信号 (Hangup)**。当终端关闭时，该终端启动的进程会收到此信号。常用于让守护进程重新加载配置文件。 || SIGQUIT | 3        | **退出信号 (Quit)**。通常由用户按下 Ctrl+\ 触发，除了终止进程外，还会生成核心转...</div></div></div></a><a class="pagination-related" href="/2025/09/11/%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F/" title="集群模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">集群模式</div></div><div class="info-2"><div class="info-item-1">集群模式对于低于每秒一百万个数据点的摄取率，建议使用单节点版本而不是集群版本。单节点版本可根据 CPU 内核、RAM 和可用存储空间的数量进行扩展。单节点版本比集群版本更容易配置和操作，所以在使用集群版本之前要三思而后行。上面我们介绍了 VM 的单节点版本的基本使用，接下来我们来介绍下如何使用集群版。 集群版主要特点：  支持单节点版本的所有功能。 性能和容量水平扩展。 支持时间序列数据的多个独立命名空间（多租户）。 支持多副本。  组件服务前面我们了解了 VM 的基本架构，对于集群模式下主要包含以下几个服务：  vmstorage：存储原始数据并返回指定标签过滤器在给定时间范围内的查询数据，当 -storageDataPath 指向的目录包含的可用空间少于 -storage.minFreeDiskSpaceBytes 时，vmstorage 节点会自动切换到只读模式，vminsert 节点也会停止向此类节点发送数据并开始将数据重新路由到剩余的 vmstorage 节点。 vminsert：接受摄取的数据并根据指标名称及其所有标签的一致性哈希将其分散存储到 vmstorage 节...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/09/11/jenkins-k8s/" title="jenkins-k8s"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">jenkins-k8s</div></div><div class="info-2"><div class="info-item-1">Jenkins 与 Kubernetes 集成的核心价值 弹性伸缩的构建环境： Jenkins 可以根据构建需求动态创建 Kubernetes Pod 作为 Jenkins Agent，构建完成后自动销毁，节省资源。 构建环境隔离与一致性： 每个构建都在独立的、预定义的 Pod 中运行，确保环境的纯净和一致性，避免“污染”和冲突。 资源利用率最大化： Kubernetes 负责调度 Agent Pod 到可用节点，优化集群资源利用。 云原生部署： 将应用程序打包成 Docker 镜像后，通过 Jenkins Pipeline 直接部署到 Kubernetes 集群。 自动化且可靠的部署： 利用 Kubernetes 的原生部署（Deployment）、服务发现（Service）、配置管理（ConfigMap&#x2F;Secret）等能力，实现声明式、不可变的基础设施部署。 可观测性与回滚： 结合 Kubernetes 的滚动更新和回滚机制，Jenkins Pipeline 可以轻松实现零停机部署和快速回滚。  Jenkins 与 Kubernetes 集成方式Jenkins 与...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Jenkens-Blue%20Ocean%20%E6%8F%92%E4%BB%B6/" title="Jenkins Blue Ocean"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Jenkins Blue Ocean</div></div><div class="info-2"><div class="info-item-1">Blue Ocean 插件的主要功能 直观的流水线可视化 (Pipeline Visualization)：  图形化流水线显示： 将复杂的 Jenkins Declarative Pipeline 转换为清晰、易懂的图形界面，展示每个阶段 (Stage) 和步骤 (Step) 的执行顺序和状态。 实时进度更新： 流水线运行时，实时高亮显示当前正在执行的阶段和步骤，让用户一眼就能看出流水线进行到哪里。 历史执行概览： 清晰地展示每次流水线执行的历史记录，包括成功、失败、不稳定等状态，以及每次执行的时长。   增强的日志查看和调试 (Enhanced Log Viewing &amp; Debugging)：  按阶段&#x2F;步骤过滤日志： 用户可以直接点击流水线图中的某个阶段或步骤，只查看该部分相关的日志，大大简化了问题排查。 高亮错误和警告： 自动识别并高亮日志中的错误或警告信息，帮助用户快速定位问题根源。 更友好的日志下载： 提供便捷的日志下载选项。   多分支流水线的优化支持 (Optimized Multibranch Pipeline Support)：  分支概览...</div></div></div></a><a class="pagination-related" href="/2025/09/11/shell-notify/" title="shell-notify"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">shell-notify</div></div><div class="info-2"><div class="info-item-1">文件监控在 Shell 中，实现文件监控主要有两种策略：  轮询检查（Polling）：定时检查文件的元数据（如修改时间、大小、校验和），适用于对实时性要求不高的场景。 事件驱动（Event-Driven）：利用系统工具（如 inotifywait）实时捕捉文件系统的事件，效率高，响应快，是生产环境中的首选方案。  下面我将分别介绍这两种方法，并重点推荐使用 inotifywait 的专业方案。  方法一：轮询检查（基于 stat 和 md5sum）这种方法简单直接，不依赖任何额外工具，但效率较低，且有延迟。 核心思路 在一个无限循环 while true; do ... done 中执行。 记录文件当前的 MD5 校验和或修改时间。 sleep 一段时间。 再次获取文件的校验和或修改时间，与之前记录的值进行比较。 如果发生变化，则执行相应操作（如发送警报、记录日志）。  示例脚本：监控 /etc/hosts 文件的内容变化1234567891011121314151617181920212223242526272829303132333435363738394041#!/bin...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Go%20nil%20silce%20%E4%B8%8E%20nil%20map/" title="Go nil silce 与 nil map"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Go nil silce 与 nil map</div></div><div class="info-2"><div class="info-item-1">您好！这是一个关于 Go 语言中 nil 值行为的非常重要且经典的问题，尤其对于后端开发人员来说，理解这些细节可以帮助我们避免运行时错误（panic）并编写更健壮的代码。Go 语言中 nil 的行为对于 slice 和 map 是不同的。  Go 语言中值为 nil 的 Slice 会发生什么？在 Go 语言中，slice 是一种引用类型，它的底层是一个结构体，包含三个字段：指向底层数组的指针、长度（len）和容量（cap）。 当一个 slice 变量被声明但未初始化时，它的值默认为 nil。 1var mySlice []int // mySlice 被声明，但没有初始化，其值为 nil  一个 nil slice 意味着：  它的底层数据指针是 nil。 它的长度 len 为 0。 它的容量 cap 为 0。  nil slice 的行为：  len(s) 和 cap(s): 对于 nil slice，len(s) 和 cap(s) 都会返回 0。这是安全的，不会引发 panic。 1234var s []intfmt.Println(s == nil)   // truef...</div></div></div></a><a class="pagination-related" href="/2025/09/11/configmap/" title="configmap"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">configmap</div></div><div class="info-2"><div class="info-item-1">ConfigMap前面我们学习了一些常用的资源对象的使用，但是单纯依靠这些资源对象，还不足以满足我们的日常需求，一个重要的需求就是应用的配置管理、敏感信息的存储和使用（如：密码、Token 等）、容器运行资源的配置、安全管控、身份认证等等。 对于应用的可变配置在 Kubernetes 中是通过一个 ConfigMap 资源对象来实现的，我们知道许多应用经常会有从配置文件、命令行参数或者环境变量中读取一些配置信息的需求，这些配置信息我们肯定不会直接写死到应用程序中去的，比如你一个应用连接一个 redis 服务，下一次想更换一个了的，还得重新去修改代码，重新制作一个镜像，这肯定是不可取的，而 ConfigMap 就给我们提供了向容器中注入配置信息的能力，不仅可以用来保存单个属性，还可以用来保存整个配置文件，比如我们可以用来配置一个 redis 服务的访问地址，也可以用来保存整个 redis 的配置文件。接下来我们就来了解下 ConfigMap 这种资源对象的使用方法。 创建ConfigMap 资源对象使用 key-value 形式的键值对来配置数据，这些数据可以在 Pod 里面使用，...</div></div></div></a><a class="pagination-related" href="/2025/09/11/%E7%9B%B4%E6%96%B9%E5%9B%BE/" title="直方图"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">直方图</div></div><div class="info-2"><div class="info-item-1">直方图在这一节中，我们将学习直方图指标，了解如何根据这些指标来计算分位数。Prometheus 中的直方图指标允许一个服务记录一系列数值的分布。直方图通常用于跟踪请求的延迟或响应大小等指标值，当然理论上它是可以跟踪任何根据某种分布而产生波动数值的大小。Prometheus 直方图是在客户端对数据进行的采样，它们使用的一些可配置的（例如延迟）bucket 桶对观察到的值进行计数，然后将这些 bucket 作为单独的时间序列暴露出来。 下图是一个非累积直方图的例子：  在 Prometheus 内部，直方图被实现为一组时间序列，每个序列代表指定桶的计数（例如10ms以下的请求数、25ms以下的请求数、50ms以下的请求数等）。 在 Prometheus 中每个 bucket 桶的计数器是累加的，这意味着较大值的桶也包括所有低数值的桶的计数。在作为直方图一部分的每个时间序列上，相应的桶由特殊的 le 标签表示。le 代表的是小于或等于。 与上面相同的直方图在 Prometheus 中的累积直方图如下所示：  可以看到在 Prometheus 中直方图的计数是累计的，这是很奇怪的，因为通...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">六一</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">274</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">45</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkinsfile-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text">Jenkinsfile 的基本类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkinsfile-Declarative-Pipeline-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">Jenkinsfile (Declarative Pipeline) 的基本结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86%E8%A7%A3%E9%87%8A%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">关键组成部分解释：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">3.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/27/hexo-beautify/" title="Hexo 博客美化笔记：从零搭建高颜值技术博客">Hexo 博客美化笔记：从零搭建高颜值技术博客</a><time datetime="2026-02-27T04:00:00.000Z" title="发表于 2026-02-27 12:00:00">2026-02-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/Jenkens-Blue%20Ocean%20%E6%8F%92%E4%BB%B6/" title="Jenkins Blue Ocean">Jenkins Blue Ocean</a><time datetime="2025-09-11T12:42:57.000Z" title="发表于 2025-09-11 20:42:57">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/jenkins-jenkinsfile/" title="Jenkins Jenkinsfile">Jenkins Jenkinsfile</a><time datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/shell-trap/" title="Linux-trap">Linux-trap</a><time datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/shell-%E6%95%B0%E7%BB%84/" title="Shell-数组">Shell-数组</a><time datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 六一</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body></html>
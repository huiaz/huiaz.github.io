<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>磁盘管理 | Hui's Blog</title><meta name="author" content="六一"><meta name="copyright" content="六一"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Linux 系统中的磁盘管理 一、查看磁盘分区信息在 Linux 系统中，有多种命令可以查看磁盘和分区的信息。 1. lsblk：列出块设备信息（最常用、最直观）lsblk 命令以树状结构列出所有块设备（包括磁盘、分区、RAID设备、LVM逻辑卷等），清晰地展示了设备之间的层次关系。 1lsblk  示例输出及解释： 12345678910NAME        MAJ:MIN RM   SIZE">
<meta property="og:type" content="article">
<meta property="og:title" content="磁盘管理">
<meta property="og:url" content="https://huiaz.github.io/2025/09/11/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Hui&#39;s Blog">
<meta property="og:description" content="Linux 系统中的磁盘管理 一、查看磁盘分区信息在 Linux 系统中，有多种命令可以查看磁盘和分区的信息。 1. lsblk：列出块设备信息（最常用、最直观）lsblk 命令以树状结构列出所有块设备（包括磁盘、分区、RAID设备、LVM逻辑卷等），清晰地展示了设备之间的层次关系。 1lsblk  示例输出及解释： 12345678910NAME        MAJ:MIN RM   SIZE">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://huiaz.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-09-11T12:32:34.000Z">
<meta property="article:modified_time" content="2025-09-11T14:10:46.073Z">
<meta property="article:author" content="六一">
<meta property="article:tag" content="运维">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://huiaz.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "磁盘管理",
  "url": "https://huiaz.github.io/2025/09/11/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/",
  "image": "https://huiaz.github.io/img/butterfly-icon.png",
  "datePublished": "2025-09-11T12:32:34.000Z",
  "dateModified": "2025-09-11T14:10:46.073Z",
  "author": [
    {
      "@type": "Person",
      "name": "六一",
      "url": "https://huiaz.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://huiaz.github.io/2025/09/11/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '磁盘管理',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">274</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">45</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hui's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">磁盘管理</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">磁盘管理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-11T12:32:34.000Z" title="发表于 2025-09-11 20:32:34">2025-09-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-11T14:10:46.073Z" title="更新于 2025-09-11 22:10:46">2025-09-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/Manage/">Manage</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h3 id="Linux-系统中的磁盘管理"><a href="#Linux-系统中的磁盘管理" class="headerlink" title="Linux 系统中的磁盘管理"></a>Linux 系统中的磁盘管理</h3><hr>
<h3 id="一、查看磁盘分区信息"><a href="#一、查看磁盘分区信息" class="headerlink" title="一、查看磁盘分区信息"></a>一、查看磁盘分区信息</h3><p>在 Linux 系统中，有多种命令可以查看磁盘和分区的信息。</p>
<h4 id="1-lsblk：列出块设备信息（最常用、最直观）"><a href="#1-lsblk：列出块设备信息（最常用、最直观）" class="headerlink" title="1. lsblk：列出块设备信息（最常用、最直观）"></a>1. <code>lsblk</code>：列出块设备信息（最常用、最直观）</h4><p><code>lsblk</code> 命令以树状结构列出所有块设备（包括磁盘、分区、RAID设备、LVM逻辑卷等），清晰地展示了设备之间的层次关系。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure>

<p><strong>示例输出及解释：</strong></p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda           8:0   <span class="number"> 0 </span>  200G <span class="number"> 0 </span>disk </span><br><span class="line">├─sda1        8:1   <span class="number"> 0 </span>    1G <span class="number"> 0 </span>part /boot</span><br><span class="line">├─sda2        8:2   <span class="number"> 0 </span>    4G <span class="number"> 0 </span>part [SWAP]</span><br><span class="line">└─sda3        8:3   <span class="number"> 0 </span>195.9G <span class="number"> 0 </span>part </span><br><span class="line">  ├─vg01-root 253:0   <span class="number"> 0 </span>   50G <span class="number"> 0 </span>lvm  /</span><br><span class="line">  └─vg01-home 253:1   <span class="number"> 0 </span>145.9G <span class="number"> 0 </span>lvm  /home</span><br><span class="line">sdb           8:16  <span class="number"> 0 </span>    1T <span class="number"> 0 </span>disk </span><br><span class="line">└─sdb1        8:17  <span class="number"> 0 </span>    1T <span class="number"> 0 </span>part /mnt/data</span><br><span class="line">sr0          11:0   <span class="number"> 1 </span> 1024M <span class="number"> 0 </span>rom</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>NAME</code></strong>: 设备名称（如 <code>sda</code> 代表第一块SCSI&#x2F;SATA硬盘，<code>sda1</code> 代表 <code>sda</code> 上的第一个分区）。</li>
<li><strong><code>MAJ:MIN</code></strong>: 主设备号和次设备号。</li>
<li><strong><code>RM</code></strong>: 只读设备（1表示可移动设备如U盘）。</li>
<li><strong><code>SIZE</code></strong>: 设备大小。</li>
<li><strong><code>RO</code></strong>: 只读（1表示只读设备）。</li>
<li><strong><code>TYPE</code></strong>: 设备类型 (disk-磁盘, part-分区, lvm-LVM逻辑卷, rom-光驱)。</li>
<li><strong><code>MOUNTPOINT</code></strong>: 挂载点（如果已挂载）。</li>
</ul>
<p><strong>常用参数：</strong></p>
<ul>
<li><code>lsblk -f</code>: 显示文件系统类型（FSTYPE）、UUID等更详细的信息。</li>
<li><code>lsblk -p</code>: 显示完整的设备路径，如 <code>/dev/sda1</code>。</li>
</ul>
<h4 id="2-fdisk-l：列出磁盘分区表信息（传统方式）"><a href="#2-fdisk-l：列出磁盘分区表信息（传统方式）" class="headerlink" title="2. fdisk -l：列出磁盘分区表信息（传统方式）"></a>2. <code>fdisk -l</code>：列出磁盘分区表信息（传统方式）</h4><p><code>fdisk</code> 是一个强大的分区管理工具，<code>l</code> 参数用于列出所有磁盘的分区表信息。它通常用于MBR（Master Boot Record）分区表。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> fdisk -l</span><br></pre></td></tr></table></figure>

<p><strong>示例输出及解释：</strong></p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Disk /dev/sda:<span class="number"> 200 </span>GiB,<span class="number"> 214748364800 </span>bytes,<span class="number"> 419430400 </span>sectors</span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes</span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes</span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes</span><br><span class="line">Disklabel type: gpt</span><br><span class="line">Disk identifier: 5F0B0661-3A26-4B8C-940B-B4109CD1B9C7</span><br><span class="line"></span><br><span class="line">Device     Start       End   Sectors  Size Type</span><br><span class="line">/dev/sda1  <span class="number"> 2048 </span> <span class="number"> 2099199 </span> <span class="number"> 2097152 </span>   1G Linux filesystem</span><br><span class="line">/dev/sda22099200  <span class="number"> 2099200 </span><span class="number"> 83886079 </span> 40G Linux swap</span><br><span class="line">/dev/sda3 <span class="number"> 419430400 </span>419430400 195.9G Linux LVM</span><br></pre></td></tr></table></figure>

<ul>
<li>显示每个磁盘的总容量、扇区大小、分区表类型（GPT&#x2F;MBR）等。</li>
<li>列出每个分区的设备名、起始&#x2F;结束扇区、大小和分区类型。</li>
<li><strong>注意：</strong> <code>fdisk</code> 主要处理 MBR 分区表。对于 GPT（GUID Partition Table）分区表，<code>gdisk</code> 是更推荐的工具，但 <code>fdisk -l</code> 也能显示 GPT 信息。</li>
</ul>
<h4 id="3-df-hT：查看已挂载的文件系统和它们的使用情况"><a href="#3-df-hT：查看已挂载的文件系统和它们的使用情况" class="headerlink" title="3. df -hT：查看已挂载的文件系统和它们的使用情况"></a>3. <code>df -hT</code>：查看已挂载的文件系统和它们的使用情况</h4><p><code>df</code> 命令用于报告文件系统磁盘空间的使用情况。<code>h</code> 表示以人类可读格式显示大小，<code>T</code> 表示显示文件系统类型。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -hT</span><br></pre></td></tr></table></figure>

<p><strong>示例输出及解释：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Filesystem                Type        Size  Used Avail Use% Mounted on</span><br><span class="line">udev                      devtmpfs    3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs                     tmpfs       797M  1.6M  795M   1% /run</span><br><span class="line">/dev/mapper/vg01-root     ext4         50G   15G   33G  32% /</span><br><span class="line">/dev/sda1                 ext4        976M  178M  732M  20% /boot</span><br><span class="line">/dev/mapper/vg01-home     ext4        141G   22G  112G  17% /home</span><br><span class="line">tmpfs                     tmpfs       3.9G     0  3.9G   0% /dev/shm</span><br><span class="line">tmpfs                     tmpfs       5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs                     tmpfs       3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sdb1                 xfs         1.0T  100G  900G  10% /mnt/data</span><br></pre></td></tr></table></figure>

<ul>
<li>显示文件系统（通常是分区或逻辑卷）、文件系统类型、总大小、已使用大小、可用大小、使用百分比和挂载点。</li>
<li><strong>关键点：</strong> <code>df</code> 只能显示<strong>已挂载</strong>的文件系统。对于未挂载的分区，你需要用 <code>lsblk</code> 或 <code>fdisk -l</code> 来查看。</li>
</ul>
<h4 id="4-blkid：查看块设备的-UUID、文件系统类型和LABEL"><a href="#4-blkid：查看块设备的-UUID、文件系统类型和LABEL" class="headerlink" title="4. blkid：查看块设备的 UUID、文件系统类型和LABEL"></a>4. <code>blkid</code>：查看块设备的 UUID、文件系统类型和LABEL</h4><p><code>blkid</code> 用于定位&#x2F;识别块设备的属性，如文件系统类型、UUID、VOLUMELABEL等。这在配置 <code>/etc/fstab</code> 或进行故障排查时非常有用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> blkid</span><br></pre></td></tr></table></figure>

<p><strong>示例输出：</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda1: <span class="attribute">UUID</span>=<span class="string">&quot;a1b2c3d4-e5f6-7890-1234-567890abcdef&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;ext4&quot;</span> <span class="attribute">PARTUUID</span>=<span class="string">&quot;1234...&quot;</span></span><br><span class="line">/dev/sda2: <span class="attribute">UUID</span>=<span class="string">&quot;f0e9d8c7-b6a5-4321-fedc-ba9876543210&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;swap&quot;</span> <span class="attribute">PARTUUID</span>=<span class="string">&quot;5678...&quot;</span></span><br><span class="line">/dev/sda3: <span class="attribute">UUID</span>=<span class="string">&quot;1A2B3C4D-5E6F-7G8H-9I0J-KLMNOPQRSTUV&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;LVM2_member&quot;</span> <span class="attribute">PARTUUID</span>=<span class="string">&quot;9012...&quot;</span></span><br><span class="line">/dev/mapper/vg01-root: <span class="attribute">UUID</span>=<span class="string">&quot;ABCDEF01-2345-6789-ABCD-EF0123456789&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;ext4&quot;</span></span><br><span class="line">/dev/mapper/vg01-home: <span class="attribute">UUID</span>=<span class="string">&quot;QRSTUVWXYZ01-2345-6789-ABCD-EF0123456789&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;ext4&quot;</span></span><br><span class="line">/dev/sdb1: <span class="attribute">UUID</span>=<span class="string">&quot;12345678-ABCD-EFAB-CDEF-1234567890AB&quot;</span> <span class="attribute">TYPE</span>=<span class="string">&quot;xfs&quot;</span> <span class="attribute">LABEL</span>=<span class="string">&quot;data_disk&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>通常在 <code>/etc/fstab</code> 中使用 <code>UUID</code> 来挂载分区，因为 <code>UUID</code> 是分区独一无二的标识符，即使设备名改变（例如，<code>/dev/sda</code> 变成了 <code>/dev/sdb</code>），系统也能正确找到并挂载分区。</li>
</ul>
<hr>
<h3 id="二、管理磁盘分区"><a href="#二、管理磁盘分区" class="headerlink" title="二、管理磁盘分区"></a>二、管理磁盘分区</h3><p>磁盘分区管理通常涉及：创建&#x2F;删除分区、格式化分区（创建文件系统）、挂载&#x2F;卸载分区。</p>
<p><strong>警告：</strong> 磁盘分区操作是危险的，<strong>务必提前备份重要数据！</strong> 任何误操作都可能导致数据丢失或系统无法启动。</p>
<h4 id="1-创建-删除-修改分区-fdisk-gdisk-parted"><a href="#1-创建-删除-修改分区-fdisk-gdisk-parted" class="headerlink" title="1. 创建&#x2F;删除&#x2F;修改分区 (fdisk&#x2F;gdisk&#x2F;parted)"></a>1. 创建&#x2F;删除&#x2F;修改分区 (<code>fdisk</code>&#x2F;<code>gdisk</code>&#x2F;<code>parted</code>)</h4><ul>
<li><p><strong><code>fdisk</code>：</strong> 最常用于 MBR 分区表。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> fdisk /dev/sdb <span class="comment"># 操作 /dev/sdb 硬盘</span></span><br></pre></td></tr></table></figure>
<p>进入 <code>fdisk</code> 交互模式后：</p>
<ul>
<li><code>m</code>: 显示帮助菜单。</li>
<li><code>p</code>: 打印当前分区表。</li>
<li><code>n</code>: 新建分区。</li>
<li><code>d</code>: 删除分区。</li>
<li><code>w</code>: 写入分区表并退出。</li>
<li><code>q</code>: 不保存更改退出。</li>
</ul>
</li>
<li><p><strong><code>gdisk</code>：</strong> 专门用于 GPT 分区表，用法和 <code>fdisk</code> 类似。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> gdisk /dev/sdb</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><code>parted</code>：</strong> 更现代、更强大的分区工具，支持 MBR 和 GPT，也支持非交互模式操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> parted /dev/sdb</span><br><span class="line"><span class="comment"># 进入交互模式</span></span><br><span class="line">(parted) <span class="built_in">print</span>          <span class="comment"># 查看分区</span></span><br><span class="line">(parted) mklabel gpt/msdos <span class="comment"># 设置分区表类型 (gpt 或 msdos/mbr)</span></span><br><span class="line">(parted) mkpart primary ext4 0% 100% <span class="comment"># 创建一个 ext4 类型的分区，从0%到100%</span></span><br><span class="line">(parted) <span class="built_in">rm</span> 1           <span class="comment"># 删除第一个分区</span></span><br><span class="line">(parted) quit           <span class="comment"># 退出</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 创建分区后，需要运行 <code>partprobe</code> 或者重启系统，使内核识别新的分区表。</p>
</li>
</ul>
<h4 id="2-格式化分区（创建文件系统）"><a href="#2-格式化分区（创建文件系统）" class="headerlink" title="2. 格式化分区（创建文件系统）"></a>2. 格式化分区（创建文件系统）</h4><p>创建分区后，需要对其进行格式化才能存储数据。常用的文件系统有 Ext4、XFS、NTFS 等。</p>
<ul>
<li><p><strong>Ext4 (Linux 常用):</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mkfs.ext4 /dev/sdb1 <span class="comment"># 格式化 /dev/sdb1 分区为 Ext4</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>XFS (高性能，大型存储常用):</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mkfs.xfs /dev/sdb1 <span class="comment"># 格式化 /dev/sdb1 分区为 XFS</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>NTFS (与 Windows 兼容):</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mkfs.ntfs /dev/sdb1 <span class="comment"># 格式化 /dev/sdb1 分区为 NTFS (可能需要安装 ntfs-3g 工具)</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-挂载-卸载分区"><a href="#3-挂载-卸载分区" class="headerlink" title="3. 挂载&#x2F;卸载分区"></a>3. 挂载&#x2F;卸载分区</h4><p>格式化后的分区必须挂载到文件系统中的某个目录才能访问。</p>
<ul>
<li><p><strong>创建挂载点：</strong> 挂载点是一个空目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> /mnt/data</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>临时挂载：</strong> 仅在当前会话有效，重启后失效。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount /dev/sdb1 /mnt/data</span><br></pre></td></tr></table></figure>
<p>验证是否挂载成功：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -hT /mnt/data</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>永久挂载（通过 <code>/etc/fstab</code>）：</strong> 推荐方式，系统启动时自动挂载。</p>
<ol>
<li><p><strong>获取分区的 UUID：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> blkid /dev/sdb1</span><br><span class="line"><span class="comment"># 假设输出为：/dev/sdb1: UUID=&quot;12345678-ABCD-EFAB-CDEF-1234567890AB&quot; TYPE=&quot;xfs&quot;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>编辑 <code>/etc/fstab</code> 文件：</strong> 使用 <code>sudo vim /etc/fstab</code> 打开文件。<br>在文件末尾添加一行，格式为：<br><code>UUID=&lt;分区UUID&gt; &lt;挂载点&gt; &lt;文件系统类型&gt; &lt;挂载选项&gt; &lt;dump&gt; &lt;pass&gt;</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加到 /etc/fstab</span></span><br><span class="line"><span class="attribute">UUID</span>=<span class="number">12345678</span>-ABCD-EFAB-CDEF-<span class="number">1234567890</span>AB /mnt/data xfs defaults <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><strong>解释：</strong></p>
<ul>
<li><code>UUID=...</code>: 使用 UUID 来标识分区，这样更稳健。</li>
<li><code>/mnt/data</code>: 挂载点目录。</li>
<li><code>xfs</code>: 文件系统类型。</li>
<li><code>defaults</code>: 标准挂载选项（rw, suid, dev, exec, auto, nouser, async）。</li>
<li><code>0</code>: <code>dump</code> 程序是否备份文件系统，0 表示不备份。</li>
<li><code>0</code>: <code>fsck</code> 检查顺序，0 表示不检查。对于非根文件系统，通常设为 0。</li>
</ul>
</li>
<li><p><strong>测试 <code>/etc/fstab</code> 配置：</strong><br>在不重启系统的情况下，可以使用 <code>mount -a</code> 命令来检查 <code>fstab</code> 配置是否有错误。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -a</span><br></pre></td></tr></table></figure>
<p>如果命令没有任何输出，并且没有错误提示，说明配置是正确的。然后再次用 <code>df -hT</code> 确认。</p>
</li>
</ol>
</li>
<li><p><strong>卸载分区：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> umount /mnt/data</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line"><span class="built_in">sudo</span> umount /dev/sdb1</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 卸载时，确保没有进程正在使用该分区上的文件或目录。否则会提示“target is busy”错误。可以使用 <code>lsof /mnt/data</code> 查找占用文件的进程，然后终止它们。</p>
</li>
</ul>
<hr>
<h3 id="三、LVM-Logical-Volume-Manager-逻辑卷管理（高级管理）"><a href="#三、LVM-Logical-Volume-Manager-逻辑卷管理（高级管理）" class="headerlink" title="三、LVM (Logical Volume Manager) 逻辑卷管理（高级管理）"></a>三、LVM (Logical Volume Manager) 逻辑卷管理（高级管理）</h3><p>对于更灵活和动态的磁盘管理，LVM 是一个强大的工具。它允许你将多个物理硬盘或分区组合成一个大的存储池，然后从中创建逻辑卷，可以根据需要调整大小。</p>
<p><strong>基本步骤：</strong></p>
<ol>
<li><strong>创建 PV (Physical Volume - 物理卷)：</strong> 将物理硬盘或分区初始化为 LVM 物理卷。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> pvcreate /dev/sdb1 /dev/sdc1</span><br></pre></td></tr></table></figure></li>
<li><strong>创建 VG (Volume Group - 卷组)：</strong> 将一个或多个 PV 组合成一个 VG。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vgcreate my_vg /dev/sdb1 /dev/sdc1</span><br></pre></td></tr></table></figure></li>
<li><strong>创建 LV (Logical Volume - 逻辑卷)：</strong> 从 VG 中划分出 LV，LV 就像一个普通分区。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> lvcreate -L 100G -n my_data_lv my_vg</span><br></pre></td></tr></table></figure></li>
<li><strong>格式化 LV：</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mkfs.ext4 /dev/mapper/my_vg-my_data_lv</span><br></pre></td></tr></table></figure></li>
<li><strong>挂载 LV：</strong> (与普通分区挂载类似)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> /mnt/data_lv</span><br><span class="line"><span class="built_in">sudo</span> mount /dev/mapper/my_vg-my_data_lv /mnt/data_lv</span><br></pre></td></tr></table></figure>
并添加到 <code>fstab</code>：<br><code>UUID=&lt;LV的UUID&gt; /mnt/data_lv ext4 defaults 0 0</code></li>
</ol>
<p><strong>LVM 的优势：</strong></p>
<ul>
<li><strong>灵活性：</strong> 运行时可以动态调整逻辑卷的大小 (缩小或扩展)。</li>
<li><strong>聚合：</strong> 可以将多个小磁盘聚合成一个大存储池。</li>
<li><strong>快照：</strong> 支持创建文件系统快照。</li>
</ul>
<hr>
<p>掌握这些命令和概念，您就能有效地在 Linux 系统中查看和管理磁盘分区，满足日常运维需求。在进行任何分区更改之前，请务必做好备份并谨慎操作！</p>
<h3 id="磁盘配额（Disk-Quotas）管理"><a href="#磁盘配额（Disk-Quotas）管理" class="headerlink" title="磁盘配额（Disk Quotas）管理"></a>磁盘配额（Disk Quotas）管理</h3><hr>
<h3 id="一、什么是磁盘配额-Disk-Quotas-？"><a href="#一、什么是磁盘配额-Disk-Quotas-？" class="headerlink" title="一、什么是磁盘配额 (Disk Quotas)？"></a>一、什么是磁盘配额 (Disk Quotas)？</h3><p>磁盘配额是 Linux 内核提供的一项功能，它允许系统管理员为文件系统上的<strong>用户</strong>或<strong>组</strong>设定限制，包括：</p>
<ol>
<li><p>**块限制 (Block Quota)**：限制用户或组可以使用的磁盘空间总量（以数据块为单位）。</p>
<ul>
<li>**软限制 (Soft Limit)**：一个警告阈值。当用户或组达到此限制时，系统会发出警告，但仍允许其在一段宽限期（Grace Period）内继续写入。</li>
<li>**硬限制 (Hard Limit)**：一个绝对限制。一旦达到此限制，用户或组无法再写入任何新的数据或创建新文件，即使在宽限期内。</li>
</ul>
</li>
<li><p>**文件限制 (Inode Quota)**：限制用户或组可以创建的文件或目录的数量（以 inode 数量为单位）。</p>
<ul>
<li>同样有软限制和硬限制。inode 数量限制可以防止用户通过创建大量小文件来耗尽文件系统中的 inode 资源，即使其磁盘空间使用量不大。</li>
</ul>
</li>
</ol>
<p><strong>主要目的：</strong></p>
<ul>
<li><strong>资源公平分配：</strong> 确保每个用户或服务获得公平的存储资源。</li>
<li><strong>防止滥用：</strong> 阻止单个用户或进程无限制地使用存储，从而影响其他用户或整个系统。</li>
<li><strong>系统稳定性：</strong> 避免磁盘空间耗尽导致系统崩溃或服务中断。</li>
</ul>
<hr>
<h3 id="二、磁盘配额管理步骤"><a href="#二、磁盘配额管理步骤" class="headerlink" title="二、磁盘配额管理步骤"></a>二、磁盘配额管理步骤</h3><p>在 Linux 系统中进行磁盘配额管理通常涉及以下几个步骤：</p>
<h4 id="1-检查内核和文件系统支持"><a href="#1-检查内核和文件系统支持" class="headerlink" title="1. 检查内核和文件系统支持"></a>1. 检查内核和文件系统支持</h4><ul>
<li>大多数现代 Linux 内核都支持配额。</li>
<li>配额功能通常需要文件系统（如 ext4, XFS, Btrfs）的支持。常见的文件系统如 ext4 和 XFS 对配额有很好的支持。</li>
</ul>
<h4 id="2-修改-etc-fstab-配置，启用配额选项"><a href="#2-修改-etc-fstab-配置，启用配额选项" class="headerlink" title="2. 修改 /etc/fstab 配置，启用配额选项"></a>2. 修改 <code>/etc/fstab</code> 配置，启用配额选项</h4><p>这一步是告诉系统在挂载文件系统时启用配额功能。</p>
<ul>
<li><p><strong>编辑 <code>/etc/fstab</code> 文件：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/fstab</span><br></pre></td></tr></table></figure></li>
<li><p><strong>找到要启用配额的文件系统行</strong>（例如 <code>/home</code> 或 <code>/var/www</code>），在挂载选项中添加 <code>usrquota</code> (用户配额) 或 <code>grpquota</code> (组配额)，或两者都加。<br><strong>示例：</strong><br>假设原始 <code>/home</code> 的 fstab 行是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda2   /home   ext4    defaults        0 2</span><br></pre></td></tr></table></figure>
<p>修改为启用用户和组配额：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda2   /home   ext4    defaults,usrquota,grpquota      0 2</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>XFS 文件系统的选项有所不同：</strong> XFS 的配额功能是其文件系统内置的，通常只需要在挂载时指定 <code>prjquota</code> (项目配额), <code>usrquota</code> 或 <code>grpquota</code> 即可。对于 XFS，通常推荐使用 <code>pquota</code> (项目配额) 或直接默认启用而不需额外参数，因为 XFS 在挂载时就已经能处理配额。但是为了明确，添加 <code>usrquota,grpquota</code> 也是可行的。<br>例如： <code>defaults,usrquota,grpquota</code><br>或者，XFS 通常只需在文件系统创建时或事后通过 <code>xfs_quota</code> 命令启用。</li>
</ul>
</li>
<li><p><strong>重新挂载文件系统</strong>（或重启系统）：<br><strong>重要：</strong> 重新挂载是必要的，除非你重启系统。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -o remount /home</span><br></pre></td></tr></table></figure>
<p>如果遇到报错，尝试先卸载再挂载（但要确保 <code>/home</code> 目录当前没有被进程使用）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> umount /home</span><br><span class="line"><span class="built_in">sudo</span> mount /home</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-安装并初始化配额工具"><a href="#3-安装并初始化配额工具" class="headerlink" title="3. 安装并初始化配额工具"></a>3. 安装并初始化配额工具</h4><ul>
<li><strong>安装 <code>quota</code> 工具包：</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For RHEL/CentOS/Fedora:</span></span><br><span class="line"><span class="built_in">sudo</span> yum install quota</span><br><span class="line"><span class="comment"># Or for newer versions:</span></span><br><span class="line"><span class="built_in">sudo</span> dnf install quota</span><br><span class="line"></span><br><span class="line"><span class="comment"># For Debian/Ubuntu:</span></span><br><span class="line"><span class="built_in">sudo</span> apt install quota</span><br></pre></td></tr></table></figure></li>
<li><strong>生成配额文件：</strong> 在文件系统根目录下（例如 <code>/home</code>）生成 <code>aquota.user</code> (用户配额文件) 和 <code>aquota.group</code> (组配额文件)。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> quotacheck -cumg /home</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-c</code>: 创建新的配额文件（如果不存在）。</li>
<li><code>-u</code>: 扫描并记录用户配额使用情况。</li>
<li><code>-g</code>: 扫描并记录组配额使用情况。</li>
<li><code>-m</code>: 在线模式，当文件系统仍挂载时执行，但可能不如离线模式精确。</li>
<li><strong>XFS 文件系统不需要这一步</strong>，XFS 的配额信息存储在文件系统元数据中。</li>
</ul>
</li>
</ul>
<h4 id="4-启用配额"><a href="#4-启用配额" class="headerlink" title="4. 启用配额"></a>4. 启用配额</h4><ul>
<li><p><strong>启用指定文件系统的配额：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> quotaon -ug /home</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-u</code>: 启用用户配额。</li>
<li><code>-g</code>: 启用组配额。</li>
</ul>
</li>
<li><p><strong>系统启动时自动启用：</strong> 如果你修改了 <code>/etc/fstab</code>，并在其中添加了 <code>usrquota,grpquota</code> 选项，那么系统下次启动时会自动启用配额。</p>
</li>
</ul>
<h4 id="5-设置用户和组的配额限制"><a href="#5-设置用户和组的配额限制" class="headerlink" title="5. 设置用户和组的配额限制"></a>5. 设置用户和组的配额限制</h4><p>这是核心步骤，设定具体的磁盘空间和文件数量限制。</p>
<ul>
<li><p><strong>设置用户配额 (<code>edquota -u &lt;username&gt;</code>)：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> edquota -u testuser</span><br></pre></td></tr></table></figure>
<p>这会打开一个文本编辑器（通常是 <code>vi</code>），显示该用户在配置了配额的文件系统上的当前配额信息，例如：</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Disk quotas for user testuser (uid 1001):</span><br><span class="line">  Filesystem               blocks       soft      hard     inodes     soft     hard</span><br><span class="line">  /dev/sda2                 <span class="number"> 48 </span>       <span class="number"> 0 </span>       <span class="number"> 0 </span>        <span class="number"> 11 </span>      <span class="number"> 0 </span>       0</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>blocks</code></strong>: 用户当前已使用的磁盘块数量。</li>
<li><strong><code>soft</code></strong>: 软限制（块）。如果达到此值，用户会收到警告。</li>
<li><strong><code>hard</code></strong>: 硬限制（块）。如果达到此值，用户将无法写入。</li>
<li><strong><code>inodes</code></strong>: 用户当前已创建的文件数量 (inode)。</li>
<li><strong><code>soft</code></strong>: 软限制（inode）。</li>
<li><strong><code>hard</code></strong>: 硬限制（inode）。</li>
</ul>
<p>修改 <code>soft</code> 和 <code>hard</code> 字段来设置限制。例如，将用户 <code>testuser</code> 在 <code>/dev/sda2</code> 上的块软限制设置为 100MB (<code>102400</code> 块，假设块大小为 1KB)，硬限制设置为 120MB (<code>122880</code> 块)，文件数量软限制 10000，硬限制 12000：</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Disk quotas for user testuser (uid 1001):</span><br><span class="line">  Filesystem               blocks       soft      hard     inodes     soft     hard</span><br><span class="line">  /dev/sda2                 <span class="number"> 48 </span>   <span class="number"> 102400 </span>  <span class="number"> 122880 </span>        <span class="number"> 11 </span>  <span class="number"> 10000 </span>   12000</span><br></pre></td></tr></table></figure>
<p>保存并退出。</p>
</li>
<li><p><strong>设置组配额 (<code>edquota -g &lt;groupname&gt;</code>)：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> edquota -g webdevs</span><br></pre></td></tr></table></figure>
<p>用法与用户配额类似。</p>
</li>
<li><p><strong>复制用户配额到其他用户 (<code>edquota -p &lt;source_user&gt; &lt;target_user&gt;</code>)：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> edquota -p testuser newuser1 newuser2</span><br></pre></td></tr></table></figure>
<p>这将把 <code>testuser</code> 的配额设置复制给 <code>newuser1</code> 和 <code>newuser2</code>。</p>
</li>
</ul>
<h4 id="6-设置宽限期-Grace-Periods"><a href="#6-设置宽限期-Grace-Periods" class="headerlink" title="6. 设置宽限期 (Grace Periods)"></a>6. 设置宽限期 (Grace Periods)</h4><p>宽限期是用户达到软限制后，在硬限制生效之前可以继续写入的时间。</p>
<ul>
<li><p><strong>编辑宽限期：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> edquota -t</span><br></pre></td></tr></table></figure>
<p>这会打开编辑器，显示块和 inode 的宽限期设置：</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Grace period before enforcing soft limits for use<span class="symbol">rs:</span></span><br><span class="line"><span class="built_in">Time</span> units may <span class="symbol">be:</span> <span class="built_in">days</span>, hours, minutes, seconds</span><br><span class="line">  Filesystem             Block grace period       Inode grace period</span><br><span class="line">  /dev/sda2                     <span class="number">7</span><span class="built_in">days</span>                    <span class="number">7</span><span class="built_in">days</span></span><br></pre></td></tr></table></figure>
<p>修改这些值，例如将宽限期设置为 5 天：</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Grace period before enforcing soft limits for use<span class="symbol">rs:</span></span><br><span class="line"><span class="built_in">Time</span> units may <span class="symbol">be:</span> <span class="built_in">days</span>, hours, minutes, seconds</span><br><span class="line">  Filesystem             Block grace period       Inode grace period</span><br><span class="line">  /dev/sda2                     <span class="number">5</span><span class="built_in">days</span>                    <span class="number">5</span><span class="built_in">days</span></span><br></pre></td></tr></table></figure>
<p>保存并退出。</p>
</li>
</ul>
<h4 id="7-查看配额使用情况"><a href="#7-查看配额使用情况" class="headerlink" title="7. 查看配额使用情况"></a>7. 查看配额使用情况</h4><ul>
<li><p><strong>查看所有用户或组的配额报告：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> repquota -ugs /home</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-u</code>: 显示用户配额。</li>
<li><code>-g</code>: 显示组配额。</li>
<li><code>-s</code>: 显示概要信息 (summary)，包括宽限期。</li>
</ul>
<p>输出示例：</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*** <span class="keyword">Report</span> <span class="keyword">for</span> user quotas <span class="keyword">on</span> /home (/dev/sda2)</span><br><span class="line"><span class="keyword">Block</span> grace <span class="built_in">time</span>: <span class="number">7</span>days, Inode grace <span class="built_in">time</span>: <span class="number">7</span>days</span><br><span class="line">                                  <span class="keyword">Block</span> limits                    <span class="keyword">File</span> limits</span><br><span class="line">User            used    soft    hard  grace    used  soft  hard  grace</span><br><span class="line"><span class="comment">----------   ------------------------------------   ---------------------------</span></span><br><span class="line">root      <span class="comment">--    44       0       0      /     11     0     0      /</span></span><br><span class="line">testuser  <span class="comment">--    48  102400  122880      /     11 10000 12000      /</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>--</code>：表示未达到软限制。</li>
<li><code>+</code>：表示已达到软限制，正在使用宽限期。</li>
<li><code>-</code>：表示已达到硬限制。</li>
<li><code>grace</code>: 显示剩余的宽限期时间，或者 <code>/</code> 表示无宽限期。</li>
</ul>
</li>
<li><p><strong>查看特定用户或组的配额使用情况：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quota -u testuser</span><br><span class="line">quota -g webdevs</span><br></pre></td></tr></table></figure>
<p>普通用户也可以使用 <code>quota</code> 命令查看自己的配额信息 (无需 <code>sudo</code>)。</p>
</li>
</ul>
<hr>
<h3 id="四、XFS-文件系统的配额管理"><a href="#四、XFS-文件系统的配额管理" class="headerlink" title="四、XFS 文件系统的配额管理"></a>四、XFS 文件系统的配额管理</h3><p>XFS 文件系统有自己特殊的配额管理工具 <code>xfs_quota</code>，其管理方式集成在文件系统内部，不需要 <code>quotacheck</code> 和 <code>aquota.*</code> 文件。</p>
<ul>
<li><p><strong>启用 XFS 文件系统配额：</strong></p>
<ul>
<li>通常在 <code>/etc/fstab</code> 中添加 <code>usrquota,grpquota</code> 即可。</li>
<li>也可以使用 <code>xfs_quota -x -c &#39;quota -u on&#39;</code> 在线启用。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;quota -u on&#x27;</span> /home</span><br><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;quota -g on&#x27;</span> /home</span><br></pre></td></tr></table></figure>
<code>-x</code> 启用专家模式，<code>-c</code> 执行命令。</li>
</ul>
</li>
<li><p><strong>设置 XFS 配额：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;limit bsoft=100m bhard=120m isoft=10000 ihard=12000 testuser&#x27;</span> /home</span><br><span class="line"><span class="comment"># bsoft/bhard: 块软/硬限制</span></span><br><span class="line"><span class="comment"># isoft/ihard: inode 软/硬限制</span></span><br></pre></td></tr></table></figure>
<p>对于组也是类似：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;limit -g bsoft=1G bhard=1.2G webdevs&#x27;</span> /home</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>查看 XFS 配额报告：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;report -hugi&#x27;</span> /home</span><br><span class="line"><span class="comment"># -h: 人类可读</span></span><br><span class="line"><span class="comment"># -u: 用户</span></span><br><span class="line"><span class="comment"># -g: 组</span></span><br><span class="line"><span class="comment"># -i: inode</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>设置 XFS 宽限期：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;timer -b 7d&#x27;</span> /home <span class="comment"># 块宽限期 7 天</span></span><br><span class="line"><span class="built_in">sudo</span> xfs_quota -x -c <span class="string">&#x27;timer -i 7d&#x27;</span> /home <span class="comment"># inode 宽限期 7 天</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="五、注意事项与运维实践"><a href="#五、注意事项与运维实践" class="headerlink" title="五、注意事项与运维实践"></a>五、注意事项与运维实践</h3><ul>
<li><strong>文件系统选择：</strong> 新的部署推荐使用 XFS 文件系统，因为它在大型文件系统和并发访问方面表现更好，且配额管理更集成。对于 ext4，<code>quota</code> 工具依然成熟可靠。</li>
<li><strong>根目录 (<code>/</code>) 配额：</strong> 不建议在根目录下设置配额，因为这可能导致系统服务写入失败，引发严重问题。通常在用户数据目录（如 <code>/home</code>）或特定应用数据目录上设置配额。</li>
<li><strong>监控：</strong> 定期检查磁盘使用情况和配额状态。当有用户接近其配额限制时，应考虑向其发送通知或采取其他措施。脚本可以定时运行 <code>repquota</code> 或 <code>xfs_quota</code> 并解析输出以进行告警。</li>
<li><strong>测试：</strong> 在生产环境部署前，务必在测试环境中充分测试配额设置，确保其按预期工作，不会意外地阻止合法操作。</li>
<li><strong>用户教育：</strong> 告知用户配额的存在，以及当他们达到软限制时应如何处理（清理文件，或申请更高的配额）。</li>
<li><strong>日志：</strong> 用户的配额违规行为通常会记录在系统日志中 (<code>/var/log/messages</code> 或 <code>journalctl</code>)，可以利用这些日志进行审计。</li>
</ul>
<p>磁盘配额是 Linux 服务器管理中保护存储资源的重要手段。通过细致的规划和配置，可以有效提升系统的健壮性和资源的公平性。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://huiaz.github.io">六一</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://huiaz.github.io/2025/09/11/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/">https://huiaz.github.io/2025/09/11/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://huiaz.github.io" target="_blank">Hui's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BF%90%E7%BB%B4/">运维</a><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/11/%E7%BD%91%E7%BB%9C%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/" title="网络命名空间"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">网络命名空间</div></div><div class="info-2"><div class="info-item-1">理解 Linux 网络命名空间如果你使用过 Docker 和 Kubernetes，那么可能应该听说过 network namespace（网络命名空间），最近在我们的 《Kubernetes 网络训练营》课程中学习到了 Linux 下面的 ip 命令的使用，本文我将演示如何使用命令通过一对 veth 接口连接不同子网中的网络命名空间的进程。 网络命名空间我们知道容器运行时使用 namespace（命名空间）内核功能对系统资源进行分区，以实现某种形式的进程隔离，这样，对一个命名空间中资源的更改不会影响其他命名空间中的资源，包括进程 ID、主机名、用户 ID、文件名和网络接口等。 网络名称空间可以虚拟化网络堆栈，每个网络名称空间都有自己的资源，例如网络接口、IP 地址、路由表、隧道、防火墙等，例如，iptables添加到网络名称空间的规则只会影响进入和离开该名称空间的流量。 ip 命令ip 命令是用来显示或操纵 Linux 主机的路由、网络设备、策略路由和隧道，是 Linux 下较新的功能强大的网络配置工具。 该命令的用法如下所示： 1234567891011ip [OPTIONS...</div></div></div></a><a class="pagination-related" href="/2025/09/11/%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80/" title="类型断言"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">类型断言</div></div><div class="info-2"><div class="info-item-1">结论：Go语言在使用类型断言时，通常不会发生值的拷贝，而是基于接口类型底层的数据表示进行类型检查和值的提取。但需要注意的是，这取决于被断言的变量的实际类型和其在接口中的存储方式。 让我们分情况详细讨论： Go接口的底层结构首先，理解Go语言接口的底层结构是理解断言行为的关键。Go语言的接口有两种形式：  **空接口 (interface&#123;&#125;)**：可以存储任何类型的值。 **非空接口 (interface S)**：存储实现了接口 S 的任意类型的值。  无论哪种，接口变量在内存中通常由两部分组成：  类型（Type）信息：一个指向实际值类型的指针。 值（Value）信息：一个指向实际值的指针，或者如果值很小（如基本类型、小结构体、指针），它可能直接存储值本身。  类型断言的机制类型断言的语法是 value, ok := i.(Type) 或 value := i.(Type) (不检查 ok)。 当进行类型断言时，Go运行时会执行以下操作：  检查类型信息：比较接口变量中存储的类型信息是否与断言的 Type 匹配。 提取值：如果类型匹配，则从接口变量中提取出...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/09/11/Linux%20%E7%B3%BB%E7%BB%9F%20dmesg%20%E5%91%BD%E4%BB%A4/" title="Linux 系统 dmesg 命令"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Linux 系统 dmesg 命令</div></div><div class="info-2"><div class="info-item-1">dmesg 是在 Linux 系统中排查各种底层问题（尤其是与硬件、驱动、系统启动、内存、I&#x2F;O 错误等相关的）时常用的诊断工具。它允许查看内核环形缓冲区（kernel ring buffer）中的消息，这些消息是内核在运行过程中记录的重要事件和错误信息，对于理解系统内部工作状态和定位故障至关重要。  一、dmesg 简介 全称： diagnostic message 功能： 显示内核的启动信息以及运行时内核模块和硬件设备的日志信息。这些信息存储在内核的环形缓冲区中。 特性： 持久性： 即使系统崩溃，只要重新启动，dmesg 中的最近日志通常还在（取决于是否被新日志覆盖）。 实时性： 持续记录内核事件，包括硬件初始化、设备驱动加载、系统错误、USB 设备插拔、网络事件、OOM (Out Of Memory) 杀手活动等。 独立性： 不依赖于用户空间的日志服务（如 syslogd 或 rsyslogd），因此在这些服务未启动或有问题时也能查看内核日志。     二、dmesg 的基本使用方法直接运行 dmesg 命令，默认会打印出内核环形缓冲区中的所有消息到标准输出。 1...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Linux%20%E4%B8%AD%E7%9A%84%E7%A1%AC%E9%93%BE%E6%8E%A5%E5%92%8C%E8%BD%AF%E8%BF%9E%E6%8E%A5/" title="Linux 中的硬链接和软连接"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Linux 中的硬链接和软连接</div></div><div class="info-2"><div class="info-item-1">1. 硬链接 (Hard Link)定义：硬链接是文件系统中的一种特殊引用，它指向文件系统中的同一个文件 inode（索引节点）。简单来说，一个硬链接就是原始文件的一个别名，它们共享同一个 inode。 inode 包含了文件的所有元数据，如文件类型、权限、所有者、组、大小以及数据的物理位置等信息。 创建方式：使用 ln 命令创建硬链接： 1ln [原始文件] [硬链接文件]  特点：  共享 inode： 原始文件和硬链接文件共享同一个 inode 号。你可以通过 ls -i 命令来查看。 同等地位： 对于操作系统来说，硬链接和原始文件是完全平等的。它们只是同一个文件内容的两个不同入口。 不能跨文件系统： 硬链接只能在同一个文件系统内部创建，因为 inode 号在不同的文件系统上是独立的。 不能链接目录： 出于文件系统结构完整性和避免循环引用等复杂性，不允许创建指向目录的硬链接。 删除特性： 删除硬链接文件不会影响原始文件，也不会影响其他硬链接文件，只要还有至少一个硬链接指向该 inode，文件内容就不会被删除。 只有当所有指向该 inode 的硬链接都被删除后，操作系统才会释...</div></div></div></a><a class="pagination-related" href="/2025/09/11/docker-network/" title="Docker Network"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Docker Network</div></div><div class="info-2"><div class="info-item-1">|————— | :——- | :——- | :——- | :——————————— || Bridge (自定义) | 高   | 好   | 低   | 绝大多数应用，特别是多容器应用 || Host            | 无       | 最佳 | 极低 | 追求极致性能，端口不冲突的场景     || Overlay         | 高       | 中等     | 中等     | 多主机&#x2F;Docker Swarm 集群通信   || Macvlan         | 高       | 好       | 中等     | 需要容器作为物理网络独立设备的场景 || None            | 完全 | N&#x2F;A      | 极低     | 无网络需求的任务                   | 作为运维工程师，我的首选建议是：为你的多容器应用创建一个自定义的 bridge 网络。这提供了最好的平衡点——良好的隔离性、服务发现能力、可接受的性能和简单的管理。仅在有特殊需求时，才考虑其他网络模式。 </div></div></div></a><a class="pagination-related" href="/2025/09/11/Linux%20%E5%86%85%E5%AD%98%E5%BC%82%E5%B8%B8%E6%8E%92%E6%9F%A5/" title="Linux 内存异常排查"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Linux 内存异常排查</div></div><div class="info-2"><div class="info-item-1">一、什么是 Linux 系统中的内存泄漏？简单来说，内存泄漏（Memory Leak） 指的是程序在运行过程中，动态地申请了内存空间（例如 C 语言的 malloc() 或 Java 的 new），但在使用完毕后，没有按预期释放（或无法被垃圾回收器回收）。 结果是，这部分内存既不能被当前程序再次使用，也无法被操作系统回收分配给其他程序。从操作系统的视角看，这块内存一直被该程序“合法”地占用着。随着时间的推移，泄漏的内存积少成多，最终会耗尽系统的可用物理内存和交换空间（Swap）。 一个常见的误解：很多时候，新手会把 Linux 的文件系统缓存（Cache）误认为是内存泄漏。Linux 内核会尽可能地利用空闲内存来缓存磁盘读写数据，以提高性能。在 free -h 命令中，这部分内存会显示在 buff/cache 列。这是正常且有益的行为，当应用程序需要更多内存时，内核会自动收缩这部分缓存来满足需求。 真正的内存泄漏迹象是 available（可用内存）持续、不可逆地减少，而不是 free（空闲内存）的减少。 二、内存泄漏的典型症状作为运维，我们通常不是直接看到代码，而是通过以下系统...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Linux%20%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E9%94%99%E8%AF%AF%E4%BF%AE%E6%8A%A4/" title="Linux 系统文件错误修护"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Linux 系统文件错误修护</div></div><div class="info-2"><div class="info-item-1">修复 Linux 文件系统错误 一、文件系统错误的危害文件系统错误可能导致以下问题：  数据丢失或损坏： 文件内容错乱，甚至文件消失。 系统无法启动： 根文件系统损坏可能导致系统无法挂载核心目录。 应用程序崩溃： 读取到损坏文件或元数据引发应用程序错误。 性能下降： 文件系统需要花费额外时间处理错误，导致读写变慢。 挂载失败： 损坏的文件系统可能无法被正确挂载。   二、检查文件系统错误的工具：fsckLinux 中用于检查和修复文件系统错误的主要工具是 fsck （file system check）。它实际上是一个前端程序，会根据文件系统的类型（如 ext4, xfs, fat32 等）自动调用相应的特定工具，例如 fsck.ext4, fsck.xfs 等。 重要原则：绝对不要在已挂载（mounted）的文件系统上运行 fsck，特别是读写状态下挂载的文件系统。 这可能导致数据进一步损坏或丢失。唯一的例外是根文件系统 /，在某些情况下需要在运行时以只读方式进行检查，但通常更推荐在系统启动时或进入恢复模式进行检查。 1. 检查和修复未被挂载的文件系统这是最安全和推荐的方式。 ...</div></div></div></a><a class="pagination-related" href="/2025/09/11/Linux%20%E7%B3%BB%E7%BB%9F%E4%B8%AD%20crontab/" title="Linux 系统中 crontab"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Linux 系统中 crontab</div></div><div class="info-2"><div class="info-item-1">Linux 系统中 crontab Crontab 的工作原理crontab（cron table） 是 Linux&#x2F;Unix 系统用于设置周期性执行任务的工具。它的核心是 cron 服务（或称为 crond 守护进程），这个服务在系统启动时就会自动运行，并且会一直在后台持续运行，它的主要职责是：  读取定时任务配置： cron 服务会周期性地（通常是每分钟）扫描特定的配置文件，这些文件包含了用户定义的定时任务列表。主要的配置文件位置包括：  系统级别的定时任务： /etc/crontab：系统主 cron 表，通常用于定义系统级的任务。 /etc/cron.d/：该目录下的所有文件都会被 cron 服务读取，每个文件可以定义独立的定时任务。 /etc/cron.hourly/, /etc/cron.daily/, /etc/cron.weekly/, /etc/cron.monthly/：这些目录下的脚本会分别每小时、每天、每周、每月被 cron 服务执行一次。   用户级别的定时任务： /var/spool/cron/：每个用户的 crontab -e 命令编辑的任...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">六一</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">274</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">45</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/huiaz"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Linux 系统中的磁盘管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%9F%A5%E7%9C%8B%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF"><span class="toc-number">2.</span> <span class="toc-text">一、查看磁盘分区信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-lsblk%EF%BC%9A%E5%88%97%E5%87%BA%E5%9D%97%E8%AE%BE%E5%A4%87%E4%BF%A1%E6%81%AF%EF%BC%88%E6%9C%80%E5%B8%B8%E7%94%A8%E3%80%81%E6%9C%80%E7%9B%B4%E8%A7%82%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">1. lsblk：列出块设备信息（最常用、最直观）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-fdisk-l%EF%BC%9A%E5%88%97%E5%87%BA%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E8%A1%A8%E4%BF%A1%E6%81%AF%EF%BC%88%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">2. fdisk -l：列出磁盘分区表信息（传统方式）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-df-hT%EF%BC%9A%E6%9F%A5%E7%9C%8B%E5%B7%B2%E6%8C%82%E8%BD%BD%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E5%AE%83%E4%BB%AC%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="toc-number">2.3.</span> <span class="toc-text">3. df -hT：查看已挂载的文件系统和它们的使用情况</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-blkid%EF%BC%9A%E6%9F%A5%E7%9C%8B%E5%9D%97%E8%AE%BE%E5%A4%87%E7%9A%84-UUID%E3%80%81%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B%E5%92%8CLABEL"><span class="toc-number">2.4.</span> <span class="toc-text">4. blkid：查看块设备的 UUID、文件系统类型和LABEL</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%AE%A1%E7%90%86%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">3.</span> <span class="toc-text">二、管理磁盘分区</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA-%E5%88%A0%E9%99%A4-%E4%BF%AE%E6%94%B9%E5%88%86%E5%8C%BA-fdisk-gdisk-parted"><span class="toc-number">3.1.</span> <span class="toc-text">1. 创建&#x2F;删除&#x2F;修改分区 (fdisk&#x2F;gdisk&#x2F;parted)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%88%86%E5%8C%BA%EF%BC%88%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">2. 格式化分区（创建文件系统）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%8C%82%E8%BD%BD-%E5%8D%B8%E8%BD%BD%E5%88%86%E5%8C%BA"><span class="toc-number">3.3.</span> <span class="toc-text">3. 挂载&#x2F;卸载分区</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81LVM-Logical-Volume-Manager-%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86%EF%BC%88%E9%AB%98%E7%BA%A7%E7%AE%A1%E7%90%86%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">三、LVM (Logical Volume Manager) 逻辑卷管理（高级管理）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E9%85%8D%E9%A2%9D%EF%BC%88Disk-Quotas%EF%BC%89%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">磁盘配额（Disk Quotas）管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%A3%81%E7%9B%98%E9%85%8D%E9%A2%9D-Disk-Quotas-%EF%BC%9F"><span class="toc-number">6.</span> <span class="toc-text">一、什么是磁盘配额 (Disk Quotas)？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%A3%81%E7%9B%98%E9%85%8D%E9%A2%9D%E7%AE%A1%E7%90%86%E6%AD%A5%E9%AA%A4"><span class="toc-number">7.</span> <span class="toc-text">二、磁盘配额管理步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A3%80%E6%9F%A5%E5%86%85%E6%A0%B8%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%94%AF%E6%8C%81"><span class="toc-number">7.1.</span> <span class="toc-text">1. 检查内核和文件系统支持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9-etc-fstab-%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%90%AF%E7%94%A8%E9%85%8D%E9%A2%9D%E9%80%89%E9%A1%B9"><span class="toc-number">7.2.</span> <span class="toc-text">2. 修改 &#x2F;etc&#x2F;fstab 配置，启用配额选项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E9%A2%9D%E5%B7%A5%E5%85%B7"><span class="toc-number">7.3.</span> <span class="toc-text">3. 安装并初始化配额工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%AF%E7%94%A8%E9%85%8D%E9%A2%9D"><span class="toc-number">7.4.</span> <span class="toc-text">4. 启用配额</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E5%92%8C%E7%BB%84%E7%9A%84%E9%85%8D%E9%A2%9D%E9%99%90%E5%88%B6"><span class="toc-number">7.5.</span> <span class="toc-text">5. 设置用户和组的配额限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E8%AE%BE%E7%BD%AE%E5%AE%BD%E9%99%90%E6%9C%9F-Grace-Periods"><span class="toc-number">7.6.</span> <span class="toc-text">6. 设置宽限期 (Grace Periods)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%9F%A5%E7%9C%8B%E9%85%8D%E9%A2%9D%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="toc-number">7.7.</span> <span class="toc-text">7. 查看配额使用情况</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81XFS-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%85%8D%E9%A2%9D%E7%AE%A1%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">四、XFS 文件系统的配额管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E4%B8%8E%E8%BF%90%E7%BB%B4%E5%AE%9E%E8%B7%B5"><span class="toc-number">9.</span> <span class="toc-text">五、注意事项与运维实践</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/27/hexo-beautify/" title="Hexo 博客美化笔记：从零搭建高颜值技术博客">Hexo 博客美化笔记：从零搭建高颜值技术博客</a><time datetime="2026-02-27T04:00:00.000Z" title="发表于 2026-02-27 12:00:00">2026-02-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/Jenkens-Blue%20Ocean%20%E6%8F%92%E4%BB%B6/" title="Jenkins Blue Ocean">Jenkins Blue Ocean</a><time datetime="2025-09-11T12:42:57.000Z" title="发表于 2025-09-11 20:42:57">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/jenkins-jenkinsfile/" title="Jenkins Jenkinsfile">Jenkins Jenkinsfile</a><time datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/shell-trap/" title="Linux-trap">Linux-trap</a><time datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/11/shell-%E6%95%B0%E7%BB%84/" title="Shell-数组">Shell-数组</a><time datetime="2025-09-11T12:40:44.000Z" title="发表于 2025-09-11 20:40:44">2025-09-11</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 六一</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body></html>